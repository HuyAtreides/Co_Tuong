(this.webpackJsonpfront_end=this.webpackJsonpfront_end||[]).push([[0],{127:function(e,t,a){},131:function(e,t,a){},132:function(e,t,a){},134:function(e,t,a){},135:function(e,t,a){},136:function(e,t,a){},137:function(e,t,a){},138:function(e,t,a){},139:function(e,t,a){},140:function(e,t,a){},141:function(e,t,a){},142:function(e,t,a){},143:function(e,t,a){},144:function(e,t,a){},145:function(e,t,a){},146:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),c=a(25),r=a.n(c),i=(a(90),a(91),a(15)),o=a(10),l=a(9),u=a.n(l),j=a(13),d=a(4),b=a(80),f=Object(b.io)("http://localhost:8080/play",{autoConnect:!1}),m=s.a.createContext(),h=s.a.createContext(),p=s.a.createContext(),O=function(e,t,a){f.connected&&f.disconnect(),e({type:"setPlayerInfo",value:t}),e({type:"setIsAuthenticated",value:!!a||"guest"}),f.auth={player:{playername:t.username,guest:t.guest,photo:t.photo},sessionID:a},f.connect()},v=function(e,t,a){if(f.removeAllListeners("oneSecondPass"),t)return f.emit("setTimer",!1),a({type:"setPause",value:null}),a({type:"setPauseTime",value:"restart"}),a({type:"setOpponentTimeLeftToMove",value:"restart"}),a({type:"setPlayerTimeLeftToMove",value:"restart"}),void a({type:"setTurnToMove",value:!1});a(e?{type:"setOpponentTimeLeftToMove",value:"restart"}:{type:"setPlayerTimeLeftToMove",value:"restart"}),f.emit("startTimer",!0),f.on("oneSecondPass",(function(){a(e?{type:"setPlayerTimeLeftToMove",value:null}:{type:"setOpponentTimeLeftToMove",value:null})}))},g=function(){var e=Object(j.a)(u.a.mark((function e(t,a,n){var s,c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("POST"!==t){e.next=7;break}return c={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e.next=4,fetch("http://localhost:8080/api/".concat(a),c);case 4:s=e.sent,e.next=10;break;case 7:return e.next=9,fetch("http://localhost:8080/api/".concat(a),{credentials:"include"});case 9:s=e.sent;case 10:return e.next=12,s.json();case 12:return(r=e.sent).ok=s.ok,e.abrupt("return",r);case 15:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),x=a(151),y=a(152),w=a(153),S=a(82),k=a(157),T=a(154),N=a(83),C=a(5),P=(a(127),a(1)),M=function(){var e=Object(C.b)(),t=Object(n.useContext)(p),a=Object(n.useState)(!1),s=Object(d.a)(a,2),c=s[0],r=s[1],l=Object(n.useState)(!1),b=Object(d.a)(l,2),f=b[0],m=b[1],h=Object(n.useState)(""),O=Object(d.a)(h,2),v=O[0],M=O[1],L=Object(n.useState)(""),G=Object(d.a)(L,2),I=G[0],D=G[1],R=Object(n.useState)(!1),A=Object(d.a)(R,2),E=A[0],B=A[1],F=Object(n.useState)(!1),W=Object(d.a)(F,2),V=W[0],z=W[1],q=Object(n.useState)(""),_=Object(d.a)(q,2),U=_[0],X=_[1],Y=Object(n.useState)(""),J=Object(d.a)(Y,2),Z=J[0],H=J[1],$=Object(n.useState)(!1),K=Object(d.a)($,2),Q=K[0],ee=K[1],te=Object(C.c)((function(e){return e.appState.loginError})),ae=Object(C.c)((function(e){return e.appState.isAuthenticated})),ne=function(){var e=0;return U||(e+=1,M("Please fill out this field")),Z||(e+=1,D("Please fill out this field")),0!==e},se=function(t,a){t?/Password/.test(a)?D(a):/Username/.test(a)?M(a):B(a):B(a),e({type:"setLoginError",value:null})},ce=function(){var a=Object(j.a)(u.a.mark((function a(n){var s,c,r,i,o;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),ne()||I||v){a.next=14;break}return B(null),z(!0),a.next=7,g("POST","login",{username:U,password:Z});case 7:s=a.sent,c=s.message,r=s.user,i=s.ok,o=s.sessionID,z(!1),r?t(e,r,o):se(i,c);case 14:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),re=function(){var a=Object(j.a)(u.a.mark((function a(){var n,s;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return ee(!0),a.next=3,g("GET","login-as-guest",null);case 3:n=a.sent,s=n.user,ee(!1),r(!0),t(e,s,null);case 8:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();if(Object(n.useEffect)(Object(j.a)(u.a.mark((function a(){var n,s,c,r,i;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!ae){a.next=2;break}return a.abrupt("return");case 2:if(te){a.next=15;break}return m(!0),a.next=6,g("GET","user",null);case 6:n=a.sent,s=n.message,c=n.user,r=n.ok,i=n.sessionID,m(!1),c?t(e,c,i):se(r,s),a.next=16;break;case 15:se(!1,te);case 16:case"end":return a.stop()}}),a)}))),[ae]),ae){if("guest"!==ae)return Object(P.jsx)(o.a,{to:"/"});if(c)return Object(P.jsx)(o.a,{to:"/"})}return Object(P.jsxs)(x.a,{fluid:!0,children:[Object(P.jsx)("h1",{children:"Xiangqi"}),f?Object(P.jsx)(y.a,{animation:"border",variant:"secondary",style:{width:"".concat(window.innerWidth/5,"px"),height:"".concat(window.innerWidth/5,"px"),borderWidth:"9px"}}):Object(P.jsx)(w.a,{className:"justify-content-center",children:Object(P.jsxs)(S.a,{md:{span:4},sm:{span:6},xs:{span:10},className:"login-component d-flex flex-column  align-items-center",children:[E?Object(P.jsx)("p",{className:"error-message",children:E}):null,Object(P.jsxs)(k.a,{onSubmit:ce,method:"POST",children:[Object(P.jsx)(k.a.Group,{controlId:"username-or-email",children:Object(P.jsxs)(T.a,{hasValidation:!0,children:[Object(P.jsx)(k.a.Control,{type:"text",isInvalid:""!==v,placeholder:"Username or Email",onChange:function(e){var t=e.target.value;M(""),X(t)},value:U}),Object(P.jsx)(k.a.Control.Feedback,{type:"invalid",style:{textAlign:"left"},children:v})]})}),Object(P.jsx)(k.a.Group,{controlId:"password",children:Object(P.jsxs)(T.a,{hasValidation:!0,children:[Object(P.jsx)(k.a.Control,{type:"password",isInvalid:""!==I,placeholder:"Password",onChange:function(e){var t=e.target.value;t.length<6?D("Password must be atlest 6 characters"):D(""),H(t)},value:Z}),Object(P.jsx)(k.a.Control.Feedback,{type:"invalid",style:{textAlign:"left"},children:I})]})}),Object(P.jsx)(N.a,{type:"submit",children:V?Object(P.jsx)(y.a,{animation:"border",variant:"dark"}):"Log In"}),Object(P.jsx)(N.a,{className:"log-in-as-guest",onClick:re,children:Q?Object(P.jsx)(y.a,{animation:"border",variant:"dark"}):"Log In As Guest"})]}),Object(P.jsxs)("p",{className:"seperator",children:[Object(P.jsx)("span",{}),Object(P.jsx)("span",{className:"seperator-text",children:"or connect with"}),Object(P.jsx)("span",{})]}),Object(P.jsxs)("div",{className:"social-login",children:[Object(P.jsxs)("a",{className:"google",href:"http://localhost:8080/api/auth/google",children:[Object(P.jsx)("i",{className:"fab fa-google"})," Google"]}),Object(P.jsxs)("a",{className:"facebook",href:"http://localhost:8080/api/auth/facebook",children:[Object(P.jsx)("i",{className:"fab fa-facebook "})," Facebook"]}),Object(P.jsxs)("a",{className:"github",href:"http://localhost:8080/api/auth/github",children:[Object(P.jsx)("i",{className:"fab fa-github "})," Github"]})]}),Object(P.jsx)("div",{className:"sign-up-area",children:Object(P.jsx)(i.b,{to:"/signup",children:"Sign Up"})})]})})]})},L=a.p+"static/media/board-image.3c95ca99.png",G=(a(131),function(e){return Object(P.jsxs)(w.a,{md:{cols:2},className:"justify-content-around mt-5",children:[Object(P.jsx)(S.a,{className:"image-container",md:{span:4,order:1},xs:{span:10,order:2},children:Object(P.jsx)("img",{src:L,alt:""})}),Object(P.jsxs)(S.a,{className:"intro",md:{span:4,order:2},xs:{span:10,order:1},children:[Object(P.jsx)("h1",{children:"Play Xiangqi Online for Free"}),Object(P.jsx)(i.b,{className:"play-button",to:"/signin",children:"Play"})]})]})}),I=a(156),D=a(158),R=a(155),A=(a(132),function(e){var t=Object(C.b)(),a=Object(n.useContext)(m),s=Object(C.c)((function(e){return e.appState.lang})),c=function(e){var a=e.currentTarget.text;t({type:"setLang",value:a})},r=Object(C.c)((function(e){return e.appState.isAuthenticated})),o=function(){var n=Object(j.a)(u.a.mark((function n(s){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.setWaitForResponse(!0),n.next=3,g("GET","logout",null);case 3:s&&a.emit("logout"),t({type:"setIsAuthenticated",value:!1}),t({type:"setPlayerInfo",value:null}),a.disconnect();case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(n.useEffect)((function(){return a.on("accountLogout",(function(){o(null)})),function(){a.removeAllListeners("accountLogout")}}),[]),Object(P.jsxs)(I.a,{expand:"md",className:"nav-bar",children:[Object(P.jsx)(I.a.Brand,{children:Object(P.jsx)(i.b,{to:"/",className:"link-brand",children:"Xiangqi"})}),Object(P.jsx)(I.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(P.jsx)(I.a.Collapse,{id:"basic-navbar-nav",children:Object(P.jsxs)(D.a,{className:"nav",children:[Object(P.jsx)(i.b,{to:"/".concat(r&&"guest"!==r?"home":"signin"),className:"link nav-link",children:r&&"guest"!==r?"Home":"Sign In"}),Object(P.jsx)("button",{className:"link nav-link logout",onClick:o,style:{display:r&&"guest"!==r?"inline":"none"},children:"Log Out"}),Object(P.jsx)(i.b,{to:"/signup",className:"link nav-link ",style:{display:r&&"guest"!==r?"none":"inline"},children:"Sign Up"}),Object(P.jsxs)(R.a,{title:s,id:"basic-nav-dropdown",children:[Object(P.jsx)(R.a.Item,{onClick:c,children:"Ti\u1ebfng Vi\u1ec7t"}),Object(P.jsx)(R.a.Item,{onClick:c,children:"English"})]})]})})]})}),E=(a(134),a(135),a(136),function(e){var t=Object(C.b)(),a=Object(n.useContext)(m),s=Object(n.useContext)(h),c=Object(C.c)((function(e){return e.gameState.findingMatch})),r=Object(C.c)((function(e){return e.gameState.time})),i=Object(C.c)((function(e){return e.boardState.side})),o=function(a){var n=+a.currentTarget.getAttribute("value");t({type:"setTime",value:n}),e.handleToggle()},l=function(e){var a=e.currentTarget.getAttribute("value");t("black"===a?{type:"switchSide",value:["red","black"]}:{type:"switchSide",value:["black","red"]})};return Object(n.useEffect)((function(){return a.on("timeout",(function(){t({type:"setFindingMatch",value:"No Players are currently online :("})})),a.on("foundMatch",(function(e,a,n){t({type:"setOpponentInfo",value:{playername:e.playername,photo:e.photo}}),t({type:"setTime",value:n}),t({type:"setTurnToMove",value:a}),t({type:"setFoundMatch",value:!0}),s(a,!1,t)})),a.on("isInGame",(function(){t({type:"setFindingMatch",value:"Your account is currently in a game. Please try again after the game was finished"})})),function(){a.removeAllListeners("timeout"),a.removeAllListeners("foundMatch")}})),Object(P.jsx)(S.a,{md:{span:4},xs:{span:10},className:"game-controller mb-3",children:Object(P.jsxs)("div",{className:"button-container",children:[Object(P.jsxs)("div",{className:"select-side-container",children:[Object(P.jsx)(N.a,{className:"red-side",value:"red",onClick:l,disabled:!0===c,children:"Red"}),Object(P.jsx)(N.a,{className:"black-side",value:"black",onClick:l,disabled:!0===c,children:"Black"})]}),Object(P.jsxs)("div",{className:"time-select-container",children:[Object(P.jsxs)(N.a,{className:"select-timer",onClick:e.handleToggle,disabled:!0===c,children:[Object(P.jsx)("i",{className:"fas fa-clock"})," ",r+":00"," ",Object(P.jsx)("i",{className:"fas fa-angle-down"})]}),Object(P.jsxs)("div",{className:"time-select-table",style:{display:e.timeSelectorDisplay},children:[Object(P.jsx)(N.a,{onClick:o,value:"1",children:"1 min"}),Object(P.jsx)(N.a,{onClick:o,value:"3",children:"3 min"}),Object(P.jsx)(N.a,{onClick:o,value:"5",children:"5 min"}),Object(P.jsx)(N.a,{onClick:o,value:"10",children:"10 min"}),Object(P.jsx)(N.a,{onClick:o,value:"15",children:"15 min"}),Object(P.jsx)(N.a,{onClick:o,value:"30",children:"30 min"})]})]}),Object(P.jsx)(N.a,{className:"play ".concat(!0===c?"finding-opponent":""),onClick:function(){!0!==c&&(a.emit("findMatch",i,r),t({type:"setFindingMatch",value:!0}))},children:!0===c?"Finding Opponent...":c}),Object(P.jsx)(N.a,{className:"play-with-friend",disabled:!0===c,children:"Play With Friend"}),Object(P.jsx)(N.a,{className:"center-board",onClick:e.handleCenterBoard,children:"Center Board"})]})})}),B=(a(137),function(e){var t=Object(C.b)(),a=Math.floor(e.timeLeftToMove/60),c=e.timeLeftToMove%60,r=Object(n.useContext)(m),i=Object(n.useContext)(h),o=Object(C.c)((function(e){return e.boardState.turnToMove}));return Object(n.useEffect)((function(){if(0===e.timeLeftToMove&&o){var a=s.a.createRef();t({type:"setGameResult",value:"Lose"}),t({type:"setMessage",value:{type:"game result message",winner:"Opponent Won - ",reason:"Game Abandoned",className:"game-message",ref:a}}),i(null,!0,t),r.emit("gameFinish",["Won","Game Abandoned"])}}),[e.timeLeftToMove]),Object(P.jsx)("div",{className:"clock ".concat(e.turnToMove?"turn-to-move":""),children:Object(P.jsx)("span",{children:(a<10?"0"+a:a)+":"+(c<10?"0"+c:c)})})}),F=a(20);var W=function(e){for(var t=[],a=0;a<10;a++)for(var n=0;n<9;n++)if(e.board[a][n]){var s=Object(d.a)(e.board[a][n].position,2),c=s[0],r=s[1];t.push(Object(P.jsx)("image",{id:"p".concat(c).concat(r),href:"/images/Pieces/".concat(e.board[a][n].name,".png"),width:e.board[a][n].width-3,height:e.board[a][n].width-3,transform:e.board[a][n].translate,onMouseDown:e.handleMouseDown},"".concat(a).concat(n)))}return Object(P.jsx)("g",{children:t})},V=(a(138),function(e,t,a){var n=a.createSVGPoint();n.x=e,n.y=t;var s=n.matrixTransform(a.getScreenCTM().inverse());return[s.x,s.y]}),z=a(36),q=a(12),_=a(17),U=function(){function e(t,a,n,s,c){Object(q.a)(this,e),this.width=t,this.position=[a,n],this.name=s,this.side=s.split("-")[1],this.choosenSide=c,this.minCol=0,this.maxCol=8,this.minRow=0,this.maxRow=9,this.translate="translate(".concat(t*n,", ").concat(t*a,")")}return Object(_.a)(e,[{key:"move",value:function(e,t){var a="translate(".concat(e-this.width/2,", ").concat(t-this.width/2,")");this.translate=a}},{key:"checkValidMove",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=e-s,i=t-c,o=t>=this.minCol&&t<=this.maxCol&&e>=this.minRow&&e<=this.maxRow,l=this.moves.some((function(e){return e[0]===r&&e[1]===i}));if(o&&l){var u=this.putGeneralInDanger(e,t,a);return u||!0}return!1}},{key:"setPosition",value:function(e,t,a){var n=a*this.width,s=t*this.width,c="translate(".concat(n,", ").concat(s,")");return this.position=[t,a],this.translate=c,["capture"===e,t,a]}},{key:"canMoveToNewPosition",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=c*this.width,i=s*this.width;if(this.translate="translate(".concat(r,", ").concat(i,")"),this.side===this.choosenSide[1]){var o=this.checkValidMove(e,t,a);if(o&&!/translate/.test(o)){if(a[e][t].side){if(a[e][t].side!==a[s][c].side&&1===this.countPiecesBetween(e,t,a))return"capture"}else if(0===this.countPiecesBetween(e,t,a))return!0}else if(o)return o}return!1}},{key:"countPiecesBetween",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=0;if(e===s)do{c+=c>t?-1:1,a[s][c]&&r++}while(c!==t);else do{a[s+=s>e?-1:1][c]&&r++}while(s!==e);return r}},{key:"putGeneralInDanger",value:function(t,a,n){var s=n.reduce((function(e,t){return e.push(Object(F.a)(t)),e}),[]);return this.updateTmpBoard(t,a,s),e.isGeneralInDanger(s,this.side)}},{key:"updateTmpBoard",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=a[s][c];a[s][c]=0,a[e][t]=r}},{key:"canCaptureGeneral",value:function(e){var t,a=Object(d.a)(this.position,2),n=a[0],s=a[1],c=Object(z.a)(this.moves);try{for(c.s();!(t=c.n()).done;){var r=t.value,i=n+r[0],o=s+r[1];if(o>=0&&o<9&&i>=0&&i<10&&e[i][o].side&&e[i][o].side!==e[n][s].side&&1===this.countPiecesBetween(i,o,e)&&"general"===e[i][o].name.split("-")[0])return e[i][o].translate}}catch(l){c.e(l)}finally{c.f()}return!1}},{key:"animateMove",value:function(e,t,a){var n=Object(d.a)(e,2),s=n[0],c=n[1],r=Object(d.a)(this.position,2),i=r[0],o=r[1];this.DOMNode=document.querySelector("#p".concat(i).concat(o)),o===c?this.moveVertical([s,c],t,a):this.moveDiagonal([s,c],t,a)}},{key:"setTransform",value:function(e,t,a){var n=Object(d.a)(e,2),s=n[0],c=n[1],r=Object(d.a)(this.position,2),i=r[0],o=r[1],l="translate(".concat(s*this.width,", ").concat(c*this.width,")");if(this.DOMNode.setAttribute("transform",l),t){this.setPosition(null,c,s);var u=t[i][o];t[c][s]&&a({type:"setCapturedPieces",value:t[c][s]}),t[i][o]=0,t[c][s]=u,a({type:"setTurnToMove",value:!0}),a({type:"setBoard",value:Object(F.a)(t)})}}},{key:"moveVertical",value:function(e,t,a){var n=this,s=Object(d.a)(e,2),c=s[0],r=s[1],i=Object(d.a)(this.position,2),o=i[0],l=i[1],u=0;window.requestAnimationFrame((function e(){Math.abs(u)<Math.abs(c-o)?(u+=(c-o)/15,n.setTransform([l,o+u],null,null),window.requestAnimationFrame(e)):Math.abs(u)>=Math.abs(c-o)&&n.setTransform([r,c],t,a)}))}},{key:"moveDiagonal",value:function(e,t,a){var n=this,s=Object(d.a)(e,2),c=s[0],r=s[1],i=Object(d.a)(this.position,2),o=i[0],l=i[1],u=0;window.requestAnimationFrame((function e(){if(Math.abs(u)<Math.abs(r-l)){var s=(u+=(r-l)/15)/(r-l)*(c-o)+o;n.setTransform([l+u,s],null,null),window.requestAnimationFrame(e)}else Math.abs(u)>=Math.abs(r-l)&&n.setTransform([r,c],t,a)}))}}],[{key:"isGeneralInDanger",value:function(e,t){for(var a=0;a<10;a++)for(var n=0;n<9;n++)if(e[a][n]&&e[a][n].side!==t){var s=e[a][n].canCaptureGeneral(e);if(/translate/.test(s))return s}return!1}},{key:"isLost",value:function(t,a){for(var n=0;n<10;n++)for(var s=0;s<9;s++)if(t[n][s]&&t[n][s].side===a){var c,r=Object(d.a)(t[n][s].position,2),i=r[0],o=r[1],l=Object(z.a)(t[n][s].moves);try{for(l.s();!(c=l.n()).done;){var u=c.value,j=i+u[0],b=o+u[1],f=t[n][s].canMoveToNewPosition(j,b,t);if(f&&!/translate/.test(f))return null}}catch(m){l.e(m)}finally{l.f()}}return e.isGeneralInDanger(t,a)?"Checkmate":"Stalemate"}}]),e}();function X(){var e=Object(C.b)(),t=Object(C.c)((function(e){return e.boardState.board})),a=Object(C.c)((function(e){return e.boardState.targetDisplay})),c=Object(C.c)((function(e){return e.boardState.boardSize})),r=Object(C.c)((function(e){return e.boardState.currentPiece})),i=Object(C.c)((function(e){return e.boardState.getClicked})),o=Object(C.c)((function(e){return e.boardState.draggable})),l=Object(n.useState)("none"),u=Object(d.a)(l,2),j=u[0],b=u[1],f=Object(n.useState)("translate(0, 0)"),p=Object(d.a)(f,2),O=p[0],v=p[1],g=Object(C.c)((function(e){return e.boardState.side})),x=Object(n.useRef)(),y=Object(C.c)((function(e){return e.boardState.targetTranslate})),w=Object(C.c)((function(e){return e.boardState.turnToMove})),S=Object(n.useContext)(m),k=Object(n.useContext)(h),T=Object(C.c)((function(e){return e.gameState.opponentInfo})),N=function(a,n){var s=Object(d.a)(n,2),c=s[0],i=s[1];if(a&&!/translate/.test(a)){var o=Object(d.a)(a,3),l=o[0],u=o[1],j=o[2];l&&e({type:"setCapturedPieces",value:t[u][j]}),t[c][i]=0,t[u][j]=r}else a&&(setTimeout((function(){b("none")}),400),b("inline"),v(a))},M=function(a){if(r){var n=null,s=x.current,c=V(+a.clientX,+a.clientY,s),o=Object(d.a)(c,2),l=o[0],u=o[1],j=Math.floor(l/r.width),b=Math.floor(u/r.width),f=Object(d.a)(r.position,2),m=f[0],h=f[1],p=r.canMoveToNewPosition(b,j,t);w&&p&&!/translate/.test(p)?n=r.setPosition(p,b,j):/translate/.test(p)&&(n=p),N(n,[m,h]),e({type:"setDraggable",value:!1}),function(t){t&&!/translate/.test(t)||i?(e({type:"setTargetDisplay",value:"none"}),e({type:"setCurrentPiece",value:null}),e({type:"setGetClicked",value:!1})):e({type:"setGetClicked",value:!0})}(n),e({type:"setBoard",value:Object(F.a)(t)}),n&&!/translate/.test(n)&&(e({type:"setTurnToMove",value:!w}),k(!1,!1,e),S.emit("opponentMove",n,[m,h]))}},L=function(a){var n=x.current,s=V(+a.clientX,+a.clientY,n),i=Object(d.a)(s,2),l=i[0],u=i[1];l>=0&&l<c[0]&&u>=0&&u<c[1]&&o&&(r.move(l,u,t),e({type:"setBoard",value:Object(F.a)(t)}))},G=function(e){return t.map((function(t){return t.map((function(t){if(t){var a=Object(d.a)(t.position,2),n=a[0],s=a[1];return t.width=e,t.translate="translate(".concat(e*s,", ").concat(e*n,")"),t}return 0}))}))},I=function(){var t=document.querySelector(".board-container").offsetWidth;e({type:"setBoardSize",value:[t,t/(521/577)]}),e({type:"setBoard",value:G(t/9)})};return Object(n.useEffect)((function(){var t=document.querySelector(".board-container").offsetWidth;e({type:"setBoardSize",value:[t,t/(521/577)]}),e({type:"setBoard",value:G(t/9)}),window.ondragstart=function(){return!1}}),[]),Object(n.useEffect)((function(){return window.onmousemove=L,window.onmouseup=M,window.onresize=I,S.on("move",(function(a,n){var s=Object(d.a)(a,2),c=s[0],r=s[1],i=Object(d.a)(n,2);!function(a,n){var s=Object(d.a)(a,2),c=s[0],r=s[1],i=Object(d.a)(n,2),o=i[0],l=i[1];t[c][r]&&t[c][r].side===g[0]&&(t[c][r].animateMove([o,l],t,e),k(!0,!1,e))}([c,r],[i[0],i[1]])})),function(){window.onmouseup=null,window.onmousemove=null,window.onresize=null,S.removeAllListeners("move")}})),Object(n.useEffect)((function(){if(w){var a=U.isLost(t,g[1]);if(a){var n=s.a.createRef();e({type:"setGameResult",value:"Lose"}),e({type:"setMessage",value:{type:"game result message",winner:"".concat(T.playername," Won - "),reason:a,className:"game-message",ref:n}}),k(null,!0,e),S.emit("gameFinish",["Won",a])}}}),[w]),Object(P.jsxs)("svg",{width:c[0],height:c[1],onClick:function(a){if(r){var n=x.current,s=V(+a.clientX,+a.clientY,n),c=Object(d.a)(s,2),i=c[0],o=c[1];a.target.id||function(a,n,s){var c=null,r=Object(d.a)(a.position,2),i=r[0],o=r[1],l=Math.floor(n/a.width),u=Math.floor(s/a.width),j=a.canMoveToNewPosition(u,l,t);w&&j&&!/translate/.test(j)&&(c=a.setPosition(j,u,l)),N(c,[i,o]),e({type:"setTargetDisplay",value:"none"}),e({type:"setCurrentPiece",value:null}),e({type:"setBoard",value:Object(F.a)(t)}),c&&!/translate/.test(c)&&(e({type:"setTurnToMove",value:!w}),k(!1,!1,e),S.emit("opponentMove",c,[i,o]))}(r,i,o)}},style:{backgroundImage:'url("/images/Board/board.jpg")'},ref:x,children:[Object(P.jsx)("image",{href:"/images/Target_Icon/target.gif",width:c[0]/9-3,height:c[0]/9-3,style:{display:a},transform:y}),Object(P.jsx)("rect",{width:c[0]/9-3,height:c[0]/9-3,style:{display:j},transform:O,fill:"brown"}),Object(P.jsx)(W,{board:t,handleMouseDown:function(a){var n=a.currentTarget.id,s=+n[1],c=+n[2],i=t[s][c].translate;if(!r||t[s][c].side===r.side){if(r){var o=Object(d.a)(r.position,2),l=o[0],u=o[1];s===l&&u===c||e({type:"setGetClicked",value:!1})}e({type:"setTargetDisplay",value:"inline"}),e({type:"setDraggable",value:!0}),e({type:"setTargetTranslate",value:i}),e({type:"setCurrentPiece",value:t[s][c]})}}})]})}var Y=s.a.memo(X),J=(a(139),a(140),function(){var e=Object(C.b)(),t=Object(C.c)((function(e){return e.gameState.gameResult})),a=Object(C.c)((function(e){return e.boardState.boardSize})),n=Object(d.a)(a,2),s=n[0],c=n[1],r=Object(C.c)((function(e){return e.gameState.gameResultDisplay})),i=Object(C.c)((function(e){return e.boardState.side})),o=Object(C.c)((function(e){return e.appState.playerInfo})),l=Object(C.c)((function(e){return e.gameState.opponentInfo})),u="Draw";"Won"===t?u="".concat(i[1].charAt(0).toUpperCase()+i[1].slice(1)," Won"):"Lose"===t&&(u="".concat(i[0].charAt(0).toUpperCase()+i[0].slice(1)," Won"));return t?Object(P.jsxs)("div",{className:"game-result",style:{width:"80%",height:"".concat(c-40,"px"),left:"".concat(.1*s,"px"),display:"".concat(r)},children:[Object(P.jsx)("i",{className:"fas fa-times hide-game-result",onClick:function(){e({type:"setGameResultDisplay",value:"none"})}}),Object(P.jsx)("div",{className:"won-side",children:Object(P.jsx)("p",{children:u})}),Object(P.jsxs)("div",{className:"players",children:[Object(P.jsxs)("div",{className:"player-info",children:[Object(P.jsx)("div",{className:"img-container ".concat("Won"===t||"Draw"===t?"":"winner"),children:Object(P.jsx)("img",{src:l.photo,alt:""})}),Object(P.jsx)("p",{children:l.playername})]}),Object(P.jsx)("span",{children:"VS"}),Object(P.jsxs)("div",{className:"player-info",children:[Object(P.jsx)("div",{className:"img-container ".concat("Won"===t?"winner":""),children:Object(P.jsx)("img",{src:o.photo,alt:""})}),Object(P.jsx)("p",{children:o.username})]})]})]}):null}),Z=(a(141),function(e){var t=Object(C.b)(),a=Object(n.useContext)(m),c=Object(n.useContext)(h),r=Object(C.c)((function(e){return e.gameState.pauseTime})),i=Math.floor(r/60),o=r%60,l=Object(C.c)((function(e){return e.boardState.turnToMove}));return Object(n.useEffect)((function(){return 0===r&&(/Paused/.test(e.pause)?(a.emit("startTimer",!0),t({type:"setPauseTime",value:"timeout"}),t({type:"setPause",value:"Timeout"})):(a.emit("startTimer",!1),t({type:"setPauseTime",value:"restart"}),t({type:"setPause",value:null}),c(l,!1,t),a.emit("startGame"))),a.on("pauseOver",(function(){var e=s.a.createRef();t({type:"setPause",value:"Timeout"}),t({type:"setPauseTime",value:"timeout"}),a.emit("starTimer",!0),t({type:"setMessage",value:{from:"",message:"Pause Timeout",className:"game-message",ref:e}})})),a.on("gameStarted",(function(){a.emit("startTimer",!1),t({type:"setPause",value:null}),t({type:"setPauseTime",value:"restart"}),c(l,!1,t)})),function(){a.removeAllListeners("pauseOver"),a.removeAllListeners("gameStarted")}}),[r]),Object(P.jsxs)("p",{className:"pause-timer",children:[/Paused/.test(e.pause)?"Resume In":"Game Will Start In",":"," ",Object(P.jsx)("span",{children:(i<10?"0"+i:i)+":"+(o<10?"0"+o:o)})]})}),H=function(){var e=Object(C.b)(),t=Object(C.c)((function(e){return e.gameState.pause})),a=Object(C.c)((function(e){return e.boardState.boardSize})),c=Object(d.a)(a,2),r=c[0],i=c[1],o=Object(C.d)(),l=Object(n.useContext)(m);return Object(n.useEffect)((function(){t&&(/Paused/.test(t)?(l.removeAllListeners("oneSecondPass"),l.emit("startTimer",!0),l.on("oneSecondPass",(function(){e({type:"setPauseTime",value:null})}))):/Resumed/.test(t)&&(l.emit("startTimer",!0),e({type:"setPauseTime",value:"timeout"})));var a=function(t){var a=o.getState().gameState.opponentInfo,n=s.a.createRef(),c={from:"".concat(a.playername),message:"".concat(t?"Paused":"Resumed"," Game"),className:"game-message",ref:n};e({type:"setMessage",value:c}),e({type:"setPause",value:"".concat(a.playername," ").concat(t?"Paused":"Resumed"," Game")})};return l.on("opponentPauseGame",(function(){a(!0)})),l.on("opponentResumeGame",(function(){a(!1)})),function(){l.removeAllListeners("opponentPauseGame"),l.removeAllListeners("opponentResumeGame")}}),[t]),t?Object(P.jsx)("div",{className:"pause",style:{width:"".concat(r,"px"),height:"".concat(i,"px")},children:Object(P.jsxs)("div",{children:[Object(P.jsx)("p",{className:"pause-announce",children:t}),Object(P.jsx)(Z,{pause:t})]})}):null},$=s.a.memo(H),K=function(e){var t=Object(C.c)((function(e){return e.gameState.opponentTimeLeftToMove})),a=Object(C.c)((function(e){return e.gameState.playerTimeLeftToMove})),n=Object(C.c)((function(e){return e.boardState.turnToMove})),s=Object(C.c)((function(e){return e.gameState.gameResult})),c=Object(C.c)((function(e){return e.gameState.foundMatch})),r=Object(C.c)((function(e){return e.boardState.capturedPieces})),i=Object(C.c)((function(e){return e.appState.playerInfo})),o=Object(C.c)((function(e){return e.gameState.opponentInfo}));return Object(P.jsxs)(S.a,{md:{span:4},sm:{span:11},xs:{span:11},className:"board-container pb-3",children:[Object(P.jsxs)("div",{className:"player-area",children:[Object(P.jsxs)("div",{className:"avatar-and-name",children:[Object(P.jsx)("img",{src:o.photo,alt:""}),Object(P.jsx)("p",{className:"user-name",children:o.playername})]}),Object(P.jsx)("div",{className:"captured-pieces",children:r.map((function(e,t){return e.side===e.choosenSide[1]?Object(P.jsx)("img",{src:"/images/Pieces/".concat(e.name,".png"),style:{width:"27px"}},"c".concat(t)):null}))}),Object(P.jsx)(B,{timeLeftToMove:t,turnToMove:c&&!s?!n:n})]}),Object(P.jsx)(Y,{}),Object(P.jsxs)("div",{className:"player-area",children:[Object(P.jsx)("div",{className:"avatar-and-name",children:Object(P.jsxs)("div",{className:"avatar-and-name",children:[Object(P.jsx)("img",{src:i.photo,alt:""}),Object(P.jsx)("p",{className:"user-name",children:i.username})]})}),Object(P.jsx)("div",{className:"captured-pieces",children:r.map((function(e,t){return e.side===e.choosenSide[0]?Object(P.jsx)("img",{src:"/images/Pieces/".concat(e.name,".png"),style:{width:"27px"}},"c".concat(t)):null}))}),Object(P.jsx)(B,{timeLeftToMove:a,turnToMove:n})]}),Object(P.jsx)(J,{}),Object(P.jsx)($,{})]})},Q=(a(142),a(143),function(e){return e.map((function(e,t){return e.type?Object(P.jsxs)("li",{ref:e.ref,className:e.className,children:[Object(P.jsx)("p",{className:"game-over",children:"Game Over"}),Object(P.jsx)("p",{children:"".concat(e.winner).concat(e.reason)})]},"m".concat(t)):Object(P.jsxs)("li",{ref:e.ref,className:e.className,children:[Object(P.jsx)("span",{children:e.from})," ",e.message]},"m".concat(t))}))}),ee=(a(144),function(e){var t=Object(C.b)(),a=Object(n.useContext)(m),c=Object(n.useContext)(h),r=Object(C.c)((function(e){return e.appState.playerInfo})),i=Object(C.c)((function(e){return e.gameState.opponentInfo})),o=Object(C.c)((function(e){return e.gameState.receiveDrawOffer})),l=function(){var e=s.a.createRef();t({type:"setGameResult",value:"Draw"}),t({type:"setMessage",value:{type:"game result message",winner:"",reason:"Game Draw By Agreement",className:"game-message",ref:e}}),c(null,!0,t)};return Object(n.useEffect)((function(){return a.on("receiveDrawOffer",(function(){t({type:"setReceiveDrawOffer",value:!0})})),a.on("draw",(function(){l()})),function(){a.removeAllListeners("draw"),a.removeAllListeners("receiveDrawOffer")}})),o?Object(P.jsxs)("li",{className:"draw-offer",style:{display:e.display},children:[Object(P.jsxs)("p",{children:[Object(P.jsx)("span",{children:i.playername})," Offer A Draw"]}),Object(P.jsxs)("div",{className:"answer",children:[Object(P.jsxs)(N.a,{className:"accept-offer",onClick:function(){t({type:"setReceiveDrawOffer",value:!1}),l(),a.emit("gameFinish","Draw")},children:["Accept ",Object(P.jsx)("i",{className:"fas fa-check"})]}),Object(P.jsxs)(N.a,{className:"decline-offer",onClick:function(){var e=s.a.createRef();t({type:"setReceiveDrawOffer",value:!1}),t({type:"setMessage",value:{from:"".concat(r.username),message:"Declined A Draw",className:"game-message",ref:e}}),a.emit("sendMessage",{from:"".concat(r.username),message:"Declined A Draw",className:"game-message",ref:e})},children:["Decline ",Object(P.jsx)("i",{className:"fas fa-times"})]})]})]}):null}),te=function(){var e=Object(C.b)(),t=Object(n.useContext)(m),a=Object(n.useState)(""),c=Object(d.a)(a,2),r=c[0],i=c[1],o=Object(n.useRef)(),l=Object(C.c)((function(e){return e.gameState.messages})),u=Object(n.useState)(!1),j=Object(d.a)(u,2),b=j[0],f=j[1],h=Q(l),p=Object(C.c)((function(e){return e.appState.playerInfo})),O=Object(C.c)((function(e){return e.gameState.opponentInfo}));return Object(n.useEffect)((function(){if(l.length>0){var a=o.current,n=l[l.length-1].ref.current;n&&(a.scrollTop=n.offsetTop)}return t.on("incomingMessage",(function(t){t.from&&"game-message"!==t.className&&(t.from="".concat(O.playername,": ")),e({type:"setMessage",value:t})})),function(){t.removeAllListeners("incomingMessage")}})),b?Object(P.jsxs)(N.a,{className:"show-chat",onClick:function(){f(!1)},children:["Show Chat",Object(P.jsx)(ee,{display:"none"})]}):Object(P.jsxs)("div",{className:"chat-section",children:[Object(P.jsx)("i",{className:"fas fa-times hide-chat",onClick:function(){f(!0)}}),Object(P.jsxs)("ul",{className:"message-container",ref:o,children:[Object(P.jsx)("li",{className:"announce-new-game",children:Object(P.jsxs)("p",{className:"versus game-message",children:[Object(P.jsx)("span",{children:O.playername})," vs"," ",Object(P.jsx)("span",{children:p.username})]})}),h]}),Object(P.jsx)(ee,{display:"flex"}),Object(P.jsxs)("form",{className:"chat-input",onSubmit:function(a){if(r){var n=s.a.createRef(),c={from:"".concat(p.username,": "),message:r,className:"",ref:n};e({type:"setMessage",value:c}),i(""),t.emit("sendMessage",c),a.preventDefault()}},children:[Object(P.jsx)("input",{type:"text",placeholder:"Message...",onChange:function(e){i(e.currentTarget.value)},value:r}),Object(P.jsx)(N.a,{className:"send-btn",type:"submit",children:"Send"})]})]})},ae=function(e){var t=Object(C.b)(),a=Object(C.c)((function(e){return e.gameState.receiveDrawOffer})),c=Object(C.c)((function(e){return e.gameState.gameResult})),r=Object(n.useContext)(m),i=Object(n.useContext)(h),o=Object(C.c)((function(e){return e.gameState.pause})),l=Object(C.c)((function(e){return e.appState.playerInfo})),u=Object(C.c)((function(e){return e.gameState.opponentInfo})),j=function(e,a){var n=s.a.createRef();t({type:"setGameResult",value:e}),t({type:"setMessage",value:{type:"game result message",winner:"".concat("".concat("Won"===e?l.username:u.playername)," Won - "),reason:a,className:"game-message",ref:n}}),i(null,!0,t)};Object(n.useEffect)((function(){return r.on("gameOver",(function(e,t){null===c&&j(e,t)})),r.on("opponentLeftGame",(function(){var e=s.a.createRef();t({type:"setMessage",value:{from:"".concat(u.playername),message:"Left The Game",className:"game-message",ref:e}})})),function(){r.removeAllListeners("opponentLeftGame"),r.removeAllListeners("gameOver")}}));return Object(P.jsxs)(S.a,{md:{span:4},xs:{span:10},className:"game-controller mb-3 game-bar-controller",children:[Object(P.jsxs)("div",{className:"button-container game-bar",children:[Object(P.jsxs)("div",{className:"select-side-container",children:[Object(P.jsx)(N.a,{className:"red-side draw-btn",value:"draw",onClick:function(){if(!a){var e=s.a.createRef();t({type:"setMessage",value:{from:"".concat(l.username),message:"Offered A Draw",className:"game-message",ref:e}}),r.emit("sendDrawOffer")}},disabled:null!==c||o,children:"\xbd Draw"}),Object(P.jsxs)(N.a,{className:"black-side resign-btn",value:"resign",onClick:function(){j("Lose","".concat(l.username," Resign")),r.emit("gameFinish",["Won","".concat(l.username," Resign")])},disabled:null!==c||o,children:[Object(P.jsx)("i",{className:"fas fa-flag"})," Resign"]})]}),Object(P.jsx)("div",{className:"time-select-container",children:Object(P.jsxs)(N.a,{className:"select-timer pause-btn",disabled:null!==c||o&&!/Paused/.test(o),id:o?"Resume":"Pause",onClick:function(e){var a=s.a.createRef(),n=e.currentTarget.id,c={from:"".concat(l.username),message:"".concat(n,"d Game"),className:"game-message",ref:a};t({type:"setMessage",value:c}),t({type:"setPause",value:"".concat(l.username," ").concat(n,"d Game")}),r.emit("player".concat(n,"Game"))},children:[Object(P.jsx)("i",{className:"fas fa-".concat(o?"play":"pause")})," ",o?"Resume":"Pause"]})})]}),Object(P.jsx)(te,{}),Object(P.jsx)(N.a,{className:"exit-game",disabled:null===c,onClick:function(){var e=document.querySelector(".board-container").offsetWidth;r.emit("exitGame"),t({type:"resetBoardState",value:e}),t({type:"resetGameState"})},children:"Exit Game"}),Object(P.jsx)(N.a,{className:"center-board",onClick:e.handleCenterBoard,children:"Center Board"})]})},ne=function(){var e=Object(C.b)(),t=Object(n.useContext)(m),a=Object(n.useContext)(h),c=Object(n.useState)("none"),r=Object(d.a)(c,2),i=r[0],o=r[1],l=Object(C.c)((function(e){return e.gameState.foundMatch})),u=Object(n.useRef)(),j=Object(n.useState)(!1),b=Object(d.a)(j,2),f=b[0],p=b[1],O=function(){p(!f)};return Object(n.useEffect)((function(){u.current=l}),[l]),Object(n.useEffect)((function(){return function(){if(u.current){var n=s.a.createRef();e({type:"setGameResult",value:"Lose"}),e({type:"setMessage",value:{type:"game result message",winner:"Opponent Won - ",reason:"Game Abandoned",className:"game-message",ref:n}}),a(null,!0,e),t.emit("gameFinish",["Won","Game Abandoned"])}}}),[]),Object(P.jsxs)(w.a,{md:{cols:1},className:"mt-3 pb-3",children:[Object(P.jsx)(K,{}),Object(P.jsx)("div",{className:"w-100",style:{display:f?"block":"none"}}),l?Object(P.jsx)(ae,{handleCenterBoard:O}):Object(P.jsx)(E,{timeSelectorDisplay:i,handleToggle:function(){o("none"===i?"flex":"none")},handleCenterBoard:O})]})},se=(a(145),function(){var e=Object(n.useState)(!1),t=Object(d.a)(e,2),a=t[0],s=t[1];return Object(P.jsxs)("div",{className:"verify-email-note",style:{display:a?"none":"block"},children:[Object(P.jsxs)("p",{children:["Look Like you haven't verified your email. Please click"," ",Object(P.jsx)(i.b,{to:"/verify-email",children:"here"})," to verify your email."]}),Object(P.jsx)("i",{className:"fas fa-times hide-note",onClick:function(){s(!0)}})]})}),ce=function(){var e=Object(C.b)(),t=Object(n.useState)(!1),a=Object(d.a)(t,2),s=a[0],c=a[1],r=Object(n.useContext)(p),i=Object(C.c)((function(e){return e.appState.playerInfo})),l=Object(C.c)((function(e){return e.appState.loginError})),b=Object(C.c)((function(e){return e.appState.lang})),f=Object(C.c)((function(e){return e.appState.isAuthenticated}));return Object(n.useEffect)(Object(j.a)(u.a.mark((function t(){var a,n,s,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f){t.next=10;break}return c(!0),t.next=4,g("GET","user",null);case 4:a=t.sent,n=a.user,s=a.sessionID,i=a.message,c(!1),n?r(e,n,s):i&&e({type:"setLoginError",value:i});case 10:case"end":return t.stop()}}),t)}))),[f]),Object(n.useEffect)((function(){document.querySelector("title").innerText="English"===b?"Xiangqi":"C\u1edd T\u01b0\u1edbng"}),[b]),l?Object(P.jsx)(o.a,{to:"/signin"}):Object(P.jsxs)(x.a,{fluid:!0,className:s?"loading":"",children:[s?Object(P.jsx)(y.a,{animation:"border",variant:"secondary",style:{width:"".concat(window.innerWidth/5,"px"),height:"".concat(window.innerWidth/5,"px"),borderWidth:"9px"}}):Object(P.jsxs)("div",{children:[Object(P.jsx)(A,{setWaitForResponse:c}),f?Object(P.jsx)(ne,{}):Object(P.jsx)(G,{})]}),!i||i.guest||i.email.verified?null:Object(P.jsx)(se,{})]})},re=function(){var e=Object(C.b)(),t=Object(C.c)((function(e){return e.appState.isAuthenticated})),a=Object(n.useContext)(p),s=Object(n.useState)(""),c=Object(d.a)(s,2),r=c[0],i=c[1],l=Object(n.useState)(""),b=Object(d.a)(l,2),f=b[0],m=b[1],h=Object(n.useState)(""),O=Object(d.a)(h,2),v=O[0],M=O[1],L=Object(n.useState)(!1),G=Object(d.a)(L,2),I=G[0],D=G[1],R=Object(n.useState)(null),A=Object(d.a)(R,2),E=A[0],B=A[1],F=Object(n.useState)(""),W=Object(d.a)(F,2),V=W[0],z=W[1],q=Object(n.useState)(""),_=Object(d.a)(q,2),U=_[0],X=_[1],Y=Object(n.useState)(""),J=Object(d.a)(Y,2),Z=J[0],H=J[1],$=Object(n.useState)(""),K=Object(d.a)($,2),Q=K[0],ee=K[1],te=Object(n.useState)(""),ae=Object(d.a)(te,2),ne=ae[0],se=ae[1],ce=Object(n.useState)(""),re=Object(d.a)(ce,2),ie=re[0],oe=re[1],le=Object(n.useState)(!1),ue=Object(d.a)(le,2),je=ue[0],de=ue[1],be=Object(n.useState)(""),fe=Object(d.a)(be,2),me=fe[0],he=fe[1],pe=Object(n.useState)(!1),Oe=Object(d.a)(pe,2),ve=Oe[0],ge=(Oe[1],function(){var e=0;return V||(e+=1,i("Please fill out this field")),U||(e+=1,M("Please fill out this field")),Q||(e+=1,se("Please fill out this field")),me||(e+=1,oe("Please fill out this field")),Z||(e+=1,m("Please fill out this field")),0!==e}),xe=function(e,t){e?/Email/.test(t)?m(t):/User/.test(t)?i(t):B(t):B(t)},ye=function(){var t=Object(j.a)(u.a.mark((function t(n){var s,c,i,o,l;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),ge()||f||v||r||ne||ie){t.next=14;break}return D(!0),B(null),t.next=7,g("POST","signup",{email:Z,firstname:Q,username:V,password:U,lastname:me});case 7:s=t.sent,c=s.message,i=s.user,o=s.ok,l=s.sessionID,D(!1),i?a(e,i,l):xe(o,c);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();if(Object(n.useEffect)(Object(j.a)(u.a.mark((function n(){var s,c,r,i,o;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=2;break}return n.abrupt("return");case 2:return de(!0),n.next=5,g("GET","user",null);case 5:s=n.sent,c=s.user,r=s.sessionID,i=s.message,o=s.ok,de(!1),c?a(e,c,r):xe(o,i);case 12:case"end":return n.stop()}}),n)}))),[t]),t){if("guest"!==t)return Object(P.jsx)(o.a,{to:"/"});if(ve)return Object(P.jsx)(o.a,{to:"/"})}return Object(P.jsxs)(x.a,{fluid:!0,children:[Object(P.jsx)("h1",{children:"Xiangqi"}),je?Object(P.jsx)(y.a,{animation:"border",variant:"secondary",style:{width:"".concat(window.innerWidth/5,"px"),height:"".concat(window.innerWidth/5,"px"),borderWidth:"9px"}}):Object(P.jsx)(w.a,{className:"justify-content-center",children:Object(P.jsxs)(S.a,{md:{span:4},sm:{span:6},xs:{span:10},className:"login-component d-flex flex-column  align-items-center",children:[E?Object(P.jsx)("p",{className:"error-message",children:E}):null,Object(P.jsxs)(k.a,{onSubmit:ye,method:"POST",children:[Object(P.jsxs)(k.a.Group,{controlId:"username",children:[Object(P.jsx)(k.a.Label,{style:{float:"left"},children:"Username"}),Object(P.jsxs)(T.a,{hasValidation:!0,children:[Object(P.jsx)(k.a.Control,{type:"text",isInvalid:""!==r,onChange:function(e){var t=e.target.value;/[^_a-z0-9]/i.test(t)||t.length<3||t.length>20?i("Username must be between 3-20 characters long and use only Latin letters and numbers"):i(""),z(t)},value:V}),Object(P.jsx)(k.a.Control.Feedback,{type:"invalid",style:{textAlign:"left"},children:r})]})]}),Object(P.jsxs)(k.a.Group,{controlId:"firstname",children:[Object(P.jsx)(k.a.Label,{style:{float:"left"},children:"Firstname"}),Object(P.jsxs)(T.a,{hasValidation:!0,children:[Object(P.jsx)(k.a.Control,{type:"text",isInvalid:""!==ne,onChange:function(e){var t=e.target.value;/[^ _a-z]/i.test(t)?se("Firstname can only contain letter, space and _"):se(""),ee(t)},value:Q}),Object(P.jsx)(k.a.Control.Feedback,{type:"invalid",style:{textAlign:"left"},children:ne})]})]}),Object(P.jsxs)(k.a.Group,{controlId:"lastname",children:[Object(P.jsx)(k.a.Label,{style:{float:"left"},children:"Lastname"}),Object(P.jsxs)(T.a,{hasValidation:!0,children:[Object(P.jsx)(k.a.Control,{type:"text",isInvalid:""!==ie,onChange:function(e){var t=e.target.value;/[^ _a-z]/i.test(t)||/[^a-z]/i.test(t[0])?/[^a-z]/i.test(t[0])?oe("First letter must be letter"):oe("Lastname can only contain letter, space and _"):oe(""),he(t)},value:me}),Object(P.jsx)(k.a.Control.Feedback,{type:"invalid",style:{textAlign:"left"},children:ie})]})]}),Object(P.jsxs)(k.a.Group,{controlId:"email",children:[Object(P.jsx)(k.a.Label,{style:{float:"left"},children:"Email"}),Object(P.jsxs)(T.a,{hasValidation:!0,children:[Object(P.jsx)(k.a.Control,{type:"text",isInvalid:""!==f,onChange:function(e){var t=e.target.value;!/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9_.\-]+$/.test(t)||/\.\./.test(t)?m("Invalid email address"):m(""),H(t)},value:Z}),Object(P.jsx)(k.a.Control.Feedback,{type:"invalid",style:{textAlign:"left"},children:f})]})]}),Object(P.jsxs)(k.a.Group,{controlId:"password",children:[Object(P.jsx)(k.a.Label,{style:{float:"left"},children:"Password"}),Object(P.jsxs)(T.a,{hasValidation:!0,children:[Object(P.jsx)(k.a.Control,{type:"password",isInvalid:""!==v,onChange:function(e){var t=e.target.value;t.length<6?M("Password must be atlest 6 characters"):M(""),X(t)},value:U}),Object(P.jsx)(k.a.Control.Feedback,{type:"invalid",style:{textAlign:"left"},children:v})]})]}),Object(P.jsx)(N.a,{type:"submit",children:I?Object(P.jsx)(y.a,{animation:"border",variant:"dark"}):"Submit"})]}),Object(P.jsxs)("p",{className:"seperator",children:[Object(P.jsx)("span",{}),Object(P.jsx)("span",{className:"seperator-text",children:"or connect with"}),Object(P.jsx)("span",{})]}),Object(P.jsxs)("div",{className:"social-login",children:[Object(P.jsxs)("a",{className:"google",href:"http://localhost:8080/api/auth/google",children:[Object(P.jsx)("i",{className:"fab fa-google"})," Google"]}),Object(P.jsxs)("a",{className:"facebook",href:"http://localhost:8080/api/auth/facebook",children:[Object(P.jsx)("i",{className:"fab fa-facebook "})," Facebook"]}),Object(P.jsxs)("a",{className:"github",href:"http://localhost:8080/api/auth/github",children:[Object(P.jsx)("i",{className:"fab fa-github "})," Github"]})]})]})})]})},ie=function(){var e=Object(C.b)(),t=Object(n.useState)(!1),a=Object(d.a)(t,2),s=a[0],c=a[1],r=Object(n.useState)(!1),i=Object(d.a)(r,2),l=i[0],b=i[1],f=Object(n.useState)(!1),m=Object(d.a)(f,2),h=m[0],p=m[1],O=Object(n.useState)(""),v=Object(d.a)(O,2),M=v[0],L=v[1],G=Object(n.useState)(""),I=Object(d.a)(G,2),D=I[0],R=I[1],A=Object(n.useState)(""),E=Object(d.a)(A,2),B=E[0],F=E[1],W=Object(n.useState)(!1),V=Object(d.a)(W,2),z=V[0],q=V[1],_=Object(n.useRef)(),U=Object(C.c)((function(e){return e.appState.playerInfo})),X=(Object(C.c)((function(e){return e.appState.isAuthenticated})),function(){var t=Object(j.a)(u.a.mark((function t(a){var n,s,r,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),M){t.next=5;break}R("Please fill in this field"),t.next=15;break;case 5:if(D){t.next=15;break}return b(!0),t.next=9,g("POST","verify-email/code",{username:U.username,correct:+_.current===+M});case 9:n=t.sent,s=n.message,r=n.ok,i=n.user,b(!1),r?i?(c(!0),e({type:"setPlayerInfo",value:i})):+_.current===+M?R("Incorrect Code"):F(s):F(s);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Y=function(){var e=Object(j.a)(u.a.mark((function e(){var t,a,n,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h||p(!0),q(!0),F(""),e.next=5,g("POST","verify-email",{email:U.email.value,lastname:U.name.lastname});case 5:t=e.sent,a=t.message,n=t.code,s=t.ok,q(!1),s?_.current=n:F(a);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return!U||s?Object(P.jsx)(o.a,{to:"/"}):Object(P.jsxs)(x.a,{fluid:!0,children:[Object(P.jsx)("h1",{children:"Xiangqi"}),Object(P.jsx)(w.a,{className:"justify-content-center",children:Object(P.jsxs)(S.a,{md:{span:3},xs:{span:10},className:"login-component d-flex flex-column  align-items-center",children:[B?Object(P.jsx)("p",{className:"error-message",children:B}):null,Object(P.jsxs)(k.a,{onSubmit:X,method:"POST",children:[Object(P.jsxs)(k.a.Group,{controlId:"verificationCode",children:[Object(P.jsx)(k.a.Label,{style:{float:"left"},children:"Enter your verification code"}),Object(P.jsxs)(T.a,{hasValidation:!0,children:[Object(P.jsx)(k.a.Control,{type:"text",name:"verificationCode",isInvalid:""!==D,onChange:function(e){var t=e.target.value;/[^0-9]/.test(t)||t.length>5?R("Invalid verification code"):R(""),L(t)},value:M,placeholder:"Verification Code"}),Object(P.jsx)(k.a.Control.Feedback,{type:"invalid",style:{textAlign:"left"},children:D})]})]}),Object(P.jsx)(N.a,{type:"submit",children:l?Object(P.jsx)(y.a,{animation:"border",variant:"dark"}):"Submit"}),Object(P.jsx)(N.a,{onClick:Y,style:{marginTop:"10px"},children:z?Object(P.jsx)(y.a,{animation:"border",variant:"dark"}):h?"Resend Verification Code":"Send Verification Code"})]})]})})]})};function oe(e){return Object(n.useEffect)((function(){return function(){f.disconnect()}}),[]),Object(P.jsx)(m.Provider,{value:f,children:Object(P.jsx)(h.Provider,{value:v,children:Object(P.jsx)(p.Provider,{value:O,children:Object(P.jsx)(i.a,{children:Object(P.jsxs)(o.d,{children:[Object(P.jsx)(o.b,{path:"/signin",children:Object(P.jsx)(M,{})}),Object(P.jsx)(o.b,{path:"/signup",children:Object(P.jsx)(re,{})}),Object(P.jsx)(o.b,{path:"/verify-email",children:Object(P.jsx)(ie,{})}),Object(P.jsx)(o.b,{path:"/",children:Object(P.jsx)(ce,{})})]})})})})})}var le=a(41),ue=a(19),je=a(18),de=[[1,1],[1,-1],[-1,1],[-1,-1]],be=function(e){Object(ue.a)(a,e);var t=Object(je.a)(a);function a(e,n,s,c,r){var i;return Object(q.a)(this,a),(i=t.call(this,e,n,s,c,r)).moves=de,i.minCol=3,i.maxCol=5,i.minRow=i.side===i.choosenSide[0]?0:7,i.maxRow=i.side===i.choosenSide[0]?2:9,i}return Object(_.a)(a,[{key:"countPiecesBetween",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=0;do{c+=c>t?-1:1,a[s+=s>e?-1:1][c]&&r++}while(c!==t||s!==e);return r}},{key:"canCaptureGeneral",value:function(){return!1}}]),a}(U),fe=[[1,0],[0,1],[-1,0],[0,-1]],me=function(e){Object(ue.a)(a,e);var t=Object(je.a)(a);function a(e,n,s,c,r){var i;return Object(q.a)(this,a),(i=t.call(this,e,n,s,c,r)).moves=fe,i}return Object(_.a)(a,[{key:"canCaptureGeneral",value:function(e){var t=Object(d.a)(this.position,2),a=t[0],n=t[1],s=a<3?1:-1;do{if(e[a+=s][n])return"general"===e[a][n].name.split("-")[0]&&e[a][n].translate}while(0!==a&&9!==a);return!1}},{key:"countPiecesBetween",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=0;if(e===s)do{c+=c>t?-1:1,a[s][c]&&r++}while(c!==t);else do{a[s+=s>e?-1:1][c]&&r++}while(s!==e);return r}}]),a}(be),he=[[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,-1],[0,-2],[0,-3],[0,-4],[0,-5],[0,-6],[0,-7],[0,-8],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,0],[-1,0],[-2,0],[-3,0],[-4,0],[-5,0],[-6,0],[-7,0],[-8,0],[-9,0]],pe=function(e){Object(ue.a)(a,e);var t=Object(je.a)(a);function a(e,n,s,c,r){var i;return Object(q.a)(this,a),(i=t.call(this,e,n,s,c,r)).moves=he,i}return Object(_.a)(a,[{key:"canMoveToNewPosition",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=c*this.width,i=s*this.width;if(this.translate="translate(".concat(r,", ").concat(i,")"),this.side===this.choosenSide[1]){var o=this.checkValidMove(e,t,a);if(o&&!/translate/.test(o)){if(a[e][t].side){if(a[e][t].side!==a[s][c].side&&2===this.countPiecesBetween(e,t,a))return"capture"}else if(0===this.countPiecesBetween(e,t,a))return!0}else if(o)return o}return!1}},{key:"canCaptureGeneral",value:function(e){var t,a=Object(d.a)(this.position,2),n=a[0],s=a[1],c=Object(z.a)(this.moves);try{for(c.s();!(t=c.n()).done;){var r=t.value,i=n+r[0],o=s+r[1];if(o>=0&&o<9&&i>=0&&i<10&&e[i][o].side&&e[i][o].side!==e[n][s].side&&2===this.countPiecesBetween(i,o,e)&&"general"===e[i][o].name.split("-")[0])return e[i][o].translate}}catch(l){c.e(l)}finally{c.f()}return!1}}]),a}(U),Oe=[[-2,-2],[2,2],[-2,2],[2,-2]],ve=function(e){Object(ue.a)(a,e);var t=Object(je.a)(a);function a(e,n,s,c,r){var i;return Object(q.a)(this,a),(i=t.call(this,e,n,s,c,r)).moves=Oe,i.maxRow=i.side===i.choosenSide[0]?4:9,i.minRow=i.side===i.choosenSide[0]?0:5,i}return Object(_.a)(a,[{key:"countPiecesBetween",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=0;do{c+=c>t?-1:1,a[s+=s>e?-1:1][c]&&r++}while(c!==t||s!==e);return r}},{key:"canCaptureGeneral",value:function(){return!1}}]),a}(U),ge=[[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,-1],[0,-2],[0,-3],[0,-4],[0,-5],[0,-6],[0,-7],[0,-8],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,0],[-1,0],[-2,0],[-3,0],[-4,0],[-5,0],[-6,0],[-7,0],[-8,0],[-9,0]],xe=function(e){Object(ue.a)(a,e);var t=Object(je.a)(a);function a(e,n,s,c,r){var i;return Object(q.a)(this,a),(i=t.call(this,e,n,s,c,r)).moves=ge,i}return a}(U),ye=[[2,1],[2,-1],[-2,1],[-2,-1],[1,2],[-1,2],[1,-2],[-1,-2]],we=function(e){Object(ue.a)(a,e);var t=Object(je.a)(a);function a(e,n,s,c,r){var i;return Object(q.a)(this,a),(i=t.call(this,e,n,s,c,r)).moves=ye,i}return Object(_.a)(a,[{key:"canMoveToNewPosition",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=c*this.width,i=s*this.width;if(this.translate="translate(".concat(r,", ").concat(i,")"),this.side===this.choosenSide[1]){var o=this.checkValidMove(e,t,a);if(o&&!/translate/.test(o)){if(!this.isBlocked(e,t,a)){if(!a[e][t].side)return!0;if(a[e][t].side!==a[s][c].side)return"capture"}}else if(o)return o}return!1}},{key:"isBlocked",value:function(e,t,a){var n=Object(d.a)(this.position,2),s=n[0],c=n[1],r=e-s,i=t-c;return 2===Math.abs(r)?0!==a[s+r/2][c]:0!==a[s][c+i/2]}},{key:"canCaptureGeneral",value:function(e){var t,a=Object(d.a)(this.position,2),n=a[0],s=a[1],c=Object(z.a)(this.moves);try{for(c.s();!(t=c.n()).done;){var r=t.value,i=n+r[0],o=s+r[1];if(o>=0&&o<9&&i>=0&&i<10&&e[i][o].side&&e[i][o].side!==e[n][s].side&&!this.isBlocked(i,o,e)&&"general"===e[i][o].name.split("-")[0])return e[i][o].translate}}catch(l){c.e(l)}finally{c.f()}return!1}}]),a}(U),Se=[[[1,0]],[[-1,0]]],ke=function(e){Object(ue.a)(a,e);var t=Object(je.a)(a);function a(e,n,s,c,r){var i;return Object(q.a)(this,a),(i=t.call(this,e,n,s,c,r)).moves=r[0]===i.side?Object(F.a)(Se[0]):Object(F.a)(Se[1]),i}return Object(_.a)(a,[{key:"setPosition",value:function(e,t,a){var n=a*this.width,s=t*this.width,c="translate(".concat(n,", ").concat(s,")");return this.position=[t,a],this.translate=c,this.side===this.choosenSide[0]?this.position[0]>4&&this.crossRiver():this.position[0]<5&&this.crossRiver(),["capture"===e,t,a]}},{key:"crossRiver",value:function(){this.moves.push([0,1]),this.moves.push([0,-1])}}]),a}(U),Te=function(e,t,a,n,s){switch(n.split("-")[0]){case"advisor":return new be(e,t,a,n,s);case"general":return new me(e,t,a,n,s);case"cannon":return new pe(e,t,a,n,s);case"soldier":return new ke(e,t,a,n,s);case"chariot":return new xe(e,t,a,n,s);case"horse":return new we(e,t,a,n,s);default:return new ve(e,t,a,n,s)}},Ne=function(e,t){for(var a=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],n=function(e){return{"0,0":"chariot-".concat(e[0]),"0,1":"horse-".concat(e[0]),"0,2":"elephant-".concat(e[0]),"0,3":"advisor-".concat(e[0]),"0,4":"general-".concat(e[0]),"0,5":"advisor-".concat(e[0]),"0,6":"elephant-".concat(e[0]),"0,7":"horse-".concat(e[0]),"0,8":"chariot-".concat(e[0]),"2,1":"cannon-".concat(e[0]),"2,7":"cannon-".concat(e[0]),"3,0":"soldier-".concat(e[0]),"3,2":"soldier-".concat(e[0]),"3,4":"soldier-".concat(e[0]),"3,6":"soldier-".concat(e[0]),"3,8":"soldier-".concat(e[0]),"6,0":"soldier-".concat(e[1]),"6,2":"soldier-".concat(e[1]),"6,4":"soldier-".concat(e[1]),"6,6":"soldier-".concat(e[1]),"6,8":"soldier-".concat(e[1]),"7,1":"cannon-".concat(e[1]),"7,7":"cannon-".concat(e[1]),"9,0":"chariot-".concat(e[1]),"9,1":"horse-".concat(e[1]),"9,2":"elephant-".concat(e[1]),"9,3":"advisor-".concat(e[1]),"9,4":"general-".concat(e[1]),"9,5":"advisor-".concat(e[1]),"9,6":"elephant-".concat(e[1]),"9,7":"horse-".concat(e[1]),"9,8":"chariot-".concat(e[1])}}(t),s=0;s<10;s++)for(var c=0;c<9;c++){var r=n[[s,c].toString()];r&&(a[s][c]=Te(e,s,c,r,t))}return a},Ce={board:Ne(520/9,["red","black"]),targetDisplay:"none",targetTranslate:"translate(0, 0)",boardSize:[520,520/(521/577)],currentPiece:null,getClicked:!1,draggable:!1,capturedPieces:[],turnToMove:!1,side:["red","black"]},Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0,a=Object.assign({},e),n=t.type,s=t.value;switch(n){case"setBoard":return a.board=s,a;case"setTargetDisplay":return a.targetDisplay=s,a;case"setTargetTranslate":return a.targetTranslate=s,a;case"setBoardSize":return a.boardSize=s,a;case"setCurrentPiece":return a.currentPiece=s,a;case"setGetClicked":return a.getClicked=s,a;case"setDraggable":return a.draggable=s,a;case"setCapturedPieces":var c=Object(F.a)(a.capturedPieces);return c.push(s),a.capturedPieces=c,a;case"setTurnToMove":return a.turnToMove=s,a;case"switchSide":var r=+document.querySelector(".board-container").offsetWidth;return a.board=Ne(r/9,s),a.side=s,a;case"resetBoardState":return Ce.board=Ne(s/9,["red","black"]),Ce.boardSize=[s,s/(521/577)],Ce;default:return e}},Me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{lang:"English",isAuthenticated:!1,playerInfo:null,loginError:null},t=arguments.length>1?arguments[1]:void 0,a=Object.assign({},e),n=t.type,s=t.value;switch(n){case"setLoginError":return a.loginError=s,a;case"setPlayerInfo":return a.playerInfo=s,a;case"setLang":return a.lang=s,a;case"setIsAuthenticated":return a.isAuthenticated=s,a;default:return e}},Le={findingMatch:"Play",foundMatch:!1,time:10,opponentTimeLeftToMove:600,playerTimeLeftToMove:600,pause:!1,pauseTime:1500,receiveDrawOffer:!1,messages:[],opponentInfo:{playername:"Opponent",photo:"https://betacssjs.chesscomfiles.com/bundles/web/images/black_400.918cdaa6.png"},gameResult:null,gameResultDisplay:"flex"},Ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0,a=Object.assign({},e),n=t.type,s=t.value;switch(n){case"setOpponentInfo":return a.opponentInfo=s,a;case"setPauseTime":return"restart"===s?a.pauseTime=1500:"timeout"===s?a.pauseTime=5:a.pauseTime-=1,a;case"setGameResult":return a.gameResult=s,a;case"setFindingMatch":return a.findingMatch=s,a;case"setFoundMatch":return a.foundMatch=s,a;case"setTime":return a.time=s,a.playerTimeLeftToMove=60*s,a.opponentTimeLeftToMove=60*s,a;case"setPlayerTimeLeftToMove":return"restart"===s?a.playerTimeLeftToMove=60*a.time:a.playerTimeLeftToMove-=1,a;case"setOpponentTimeLeftToMove":return"restart"===s?a.opponentTimeLeftToMove=60*a.time:a.opponentTimeLeftToMove-=1,a;case"setPause":return a.pause=s,a;case"setReceiveDrawOffer":return a.receiveDrawOffer=s,a;case"setMessage":var c=Object(F.a)(a.messages);return c.push(s),a.messages=c,a;case"setGameResultDisplay":return a.gameResultDisplay=s,a;case"resetGameState":return Le;default:return e}},Ie=Object(le.b)({boardState:Pe,appState:Me,gameState:Ge}),De=Object(le.c)(Ie);r.a.render(Object(P.jsx)(C.a,{store:De,children:Object(P.jsx)(oe,{})}),document.getElementById("root"))},91:function(e,t,a){}},[[146,1,2]]]);
//# sourceMappingURL=main.f5cac08d.chunk.js.map