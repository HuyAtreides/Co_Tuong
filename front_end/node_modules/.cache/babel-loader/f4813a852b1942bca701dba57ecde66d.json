{"ast":null,"code":"import _regeneratorRuntime from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import\"./Home.scss\";import{Table,Row,Col,Spinner,Container}from\"react-bootstrap\";import{useSelector,useDispatch}from\"react-redux\";import{Link,Redirect,useParams}from\"react-router-dom\";import FindMembers from\"./FindMembers/FindMembers.jsx\";import ProfileHeader from\"./ProfileHeader/ProfileHeader.jsx\";import ProfileInfo from\"./ProfileInfo/ProfileInfo.jsx\";import MatchHistory from\"./MatchHistory/MatchHistory.jsx\";import NavBar from\"../Main/NavBar/NavBar.jsx\";import callAPI from\"../App/callAPI.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(props){var dispatch=useDispatch();var _useParams=useParams(),name=_useParams.name;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),redirect=_useState4[0],setRedirect=_useState4[1];var loginError=useSelector(function(state){return state.appState.loginError;});var playerInfo=useSelector(function(state){return state.appState.playerInfo;});var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),waitForResponse=_useState6[0],setWaitForResponse=_useState6[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,_response,user,message;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!loginError){_context.next=3;break;}return _context.abrupt(\"return\");case 3:setWaitForResponse(true);if(name){_context.next=10;break;}_context.next=7;return callAPI(\"GET\",\"api/user\");case 7:response=_context.sent;_context.next=13;break;case 10:_context.next=12;return callAPI(\"POST\",\"api/user\",{username:name});case 12:response=_context.sent;case 13:setWaitForResponse(false);_response=response,user=_response.user,message=_response.message;if(user){dispatch({type:\"setPlayerInfo\",value:user});if(user.lang)dispatch({type:\"setLang\",value:user.lang});}else if(message)dispatch({type:\"setLoginError\",value:message});else if(!user&&!playerInfo){setRedirect(true);}_context.next=21;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](0);dispatch({type:\"setLoginError\",value:_context.t0.message});case 21:case\"end\":return _context.stop();}}},_callee,null,[[0,18]]);})),[]);if(redirect)return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});if(loginError)return/*#__PURE__*/_jsx(Redirect,{to:\"/signin\"});if(!playerInfo||waitForResponse)return/*#__PURE__*/_jsx(Spinner,{animation:\"border\",variant:\"secondary\",className:\"spinner\"});return/*#__PURE__*/_jsxs(Container,{fluid:true,children:[/*#__PURE__*/_jsx(NavBar,{setWaitForResponse:setWaitForResponse,setRedirect:setRedirect}),/*#__PURE__*/_jsxs(Row,{className:\"home-row mt-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"upload-pic-err\",style:{display:error?\"block\":\" none\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",onClick:function onClick(){setError(null);}}),error]}),/*#__PURE__*/_jsxs(Col,{lg:{span:8},md:{span:9},sm:{span:11},className:\"profile-info-container\",children:[/*#__PURE__*/_jsx(ProfileHeader,{setError:setError,playerInfo:playerInfo,viewOthersProfile:Boolean(name)}),/*#__PURE__*/_jsx(ProfileInfo,{playerInfo:playerInfo}),/*#__PURE__*/_jsx(MatchHistory,{playerInfo:playerInfo,viewOthersProfile:Boolean(name)})]}),/*#__PURE__*/_jsx(Col,{lg:{span:4},md:{span:9},sm:{span:11},className:\"find-players-container\",children:/*#__PURE__*/_jsx(FindMembers,{playerInfo:playerInfo})})]})]});};export default Home;","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/Components/Home/Home.jsx"],"names":["React","useEffect","useState","Table","Row","Col","Spinner","Container","useSelector","useDispatch","Link","Redirect","useParams","FindMembers","ProfileHeader","ProfileInfo","MatchHistory","NavBar","callAPI","Home","props","dispatch","name","error","setError","redirect","setRedirect","loginError","state","appState","playerInfo","waitForResponse","setWaitForResponse","response","username","user","message","type","value","lang","display","span","Boolean"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"./Home.scss\";\r\nimport { Table, Row, Col, Spinner, Container } from \"react-bootstrap\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Link, Redirect, useParams } from \"react-router-dom\";\r\nimport FindMembers from \"./FindMembers/FindMembers.jsx\";\r\nimport ProfileHeader from \"./ProfileHeader/ProfileHeader.jsx\";\r\nimport ProfileInfo from \"./ProfileInfo/ProfileInfo.jsx\";\r\nimport MatchHistory from \"./MatchHistory/MatchHistory.jsx\";\r\nimport NavBar from \"../Main/NavBar/NavBar.jsx\";\r\nimport callAPI from \"../App/callAPI.js\";\r\n\r\nconst Home = (props) => {\r\n  const dispatch = useDispatch();\r\n  const { name } = useParams();\r\n  const [error, setError] = useState(null);\r\n  const [redirect, setRedirect] = useState(false);\r\n  const loginError = useSelector((state) => state.appState.loginError);\r\n  const playerInfo = useSelector((state) => state.appState.playerInfo);\r\n  const [waitForResponse, setWaitForResponse] = useState(false);\r\n\r\n  useEffect(async () => {\r\n    try {\r\n      if (loginError) return;\r\n      let response;\r\n      setWaitForResponse(true);\r\n      if (!name) response = await callAPI(\"GET\", \"api/user\");\r\n      else\r\n        response = await callAPI(\"POST\", \"api/user\", {\r\n          username: name,\r\n        });\r\n      setWaitForResponse(false);\r\n      const { user, message } = response;\r\n      if (user) {\r\n        dispatch({ type: \"setPlayerInfo\", value: user });\r\n        if (user.lang) dispatch({ type: \"setLang\", value: user.lang });\r\n      } else if (message) dispatch({ type: \"setLoginError\", value: message });\r\n      else if (!user && !playerInfo) {\r\n        setRedirect(true);\r\n      }\r\n    } catch (err) {\r\n      dispatch({ type: \"setLoginError\", value: err.message });\r\n    }\r\n  }, []);\r\n\r\n  if (redirect) return <Redirect to=\"/\" />;\r\n  if (loginError) return <Redirect to=\"/signin\" />;\r\n  if (!playerInfo || waitForResponse)\r\n    return (\r\n      <Spinner animation=\"border\" variant=\"secondary\" className=\"spinner\" />\r\n    );\r\n\r\n  return (\r\n    <Container fluid>\r\n      <NavBar\r\n        setWaitForResponse={setWaitForResponse}\r\n        setRedirect={setRedirect}\r\n      />\r\n      <Row className=\"home-row mt-3\">\r\n        <p\r\n          className=\"upload-pic-err\"\r\n          style={{ display: error ? \"block\" : \" none\" }}\r\n        >\r\n          <i\r\n            className=\"fas fa-times\"\r\n            onClick={() => {\r\n              setError(null);\r\n            }}\r\n          ></i>\r\n          {error}\r\n        </p>\r\n        <Col\r\n          lg={{ span: 8 }}\r\n          md={{ span: 9 }}\r\n          sm={{ span: 11 }}\r\n          className=\"profile-info-container\"\r\n        >\r\n          <ProfileHeader\r\n            setError={setError}\r\n            playerInfo={playerInfo}\r\n            viewOthersProfile={Boolean(name)}\r\n          />\r\n          <ProfileInfo playerInfo={playerInfo} />\r\n          <MatchHistory\r\n            playerInfo={playerInfo}\r\n            viewOthersProfile={Boolean(name)}\r\n          />\r\n        </Col>\r\n        <Col\r\n          lg={{ span: 4 }}\r\n          md={{ span: 9 }}\r\n          sm={{ span: 11 }}\r\n          className=\"find-players-container\"\r\n        >\r\n          <FindMembers playerInfo={playerInfo} />\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"]},"metadata":{},"sourceType":"module"}