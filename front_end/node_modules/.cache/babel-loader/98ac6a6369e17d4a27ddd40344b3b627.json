{"ast":null,"code":"import React,{useContext,useEffect}from\"react\";import{Col,Button}from\"react-bootstrap\";import\"./GameBar.scss\";import{useDispatch,useSelector}from\"react-redux\";import ChatSection from\"./ChatSection/ChatSection.jsx\";import{SocketContext,SetMoveTimerContext}from\"../../../App/context.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var GameBar=function GameBar(props){var dispatch=useDispatch();var receiveDrawOffer=useSelector(function(state){return state.gameState.receiveDrawOffer;});var gameResult=useSelector(function(state){return state.gameState.gameResult;});var socket=useContext(SocketContext);var setMoveTimer=useContext(SetMoveTimerContext);var pause=useSelector(function(state){return state.gameState.pause;});var playerInfo=useSelector(function(state){return state.appState.playerInfo;});var opponentInfo=useSelector(function(state){return state.gameState.opponentInfo;});var handlePauseOrResume=function handlePauseOrResume(event){var listItemRef=/*#__PURE__*/React.createRef();var action=event.currentTarget.id;var message={from:\"\".concat(playerInfo.username),message:\"\".concat(action,\"d Game\"),className:\"game-message\",ref:listItemRef};dispatch({type:\"setMessage\",value:message});dispatch({type:\"setPause\",value:\"\".concat(playerInfo.username,\" \").concat(action,\"d Game\")});socket.emit(\"player\".concat(action,\"Game\"));};var handleGameOver=function handleGameOver(result,reason){var listItemRef=/*#__PURE__*/React.createRef();dispatch({type:\"setGameResult\",value:result});dispatch({type:\"setMessage\",value:{type:\"game result message\",winner:\"\".concat(result===\"Won\"?\"\".concat(playerInfo.username):\"\".concat(opponentInfo.playername),\" Won - \"),reason:reason,className:\"game-message\",ref:listItemRef}});setMoveTimer(null,true,dispatch);};var handleOfferDraw=function handleOfferDraw(){if(!receiveDrawOffer){var listItemRef=/*#__PURE__*/React.createRef();dispatch({type:\"setMessage\",value:{from:\"\".concat(playerInfo.username),message:\"Offered A Draw\",className:\"game-message\",ref:listItemRef}});socket.emit(\"sendDrawOffer\");}};var handleResign=function handleResign(){handleGameOver(\"Lose\",\"\".concat(playerInfo.username,\" Resign\"));socket.emit(\"gameFinish\",[\"Won\",\"\".concat(playerInfo.username,\" Resign\")]);};useEffect(function(){socket.on(\"gameOver\",function(result,reason){if(gameResult!==null)return;handleGameOver(result,reason);});socket.on(\"opponentLeftGame\",function(){var listItemRef=/*#__PURE__*/React.createRef();dispatch({type:\"setMessage\",value:{from:\"\".concat(opponentInfo.playername),message:\"Left The Game\",className:\"game-message\",ref:listItemRef}});});return function(){socket.removeAllListeners(\"opponentLeftGame\");socket.removeAllListeners(\"gameOver\");};});var handleExit=function handleExit(){var width=document.querySelector(\".board-container\").offsetWidth;socket.emit(\"exitGame\");dispatch({type:\"resetBoardState\",value:width});dispatch({type:\"resetGameState\"});};return/*#__PURE__*/_jsxs(Col,{md:{span:4},xs:{span:10},className:\"game-controller mb-3 game-bar-controller\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"button-container game-bar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"select-side-container\",children:[/*#__PURE__*/_jsx(Button,{className:\"red-side draw-btn\",value:\"draw\",onClick:handleOfferDraw,disabled:gameResult!==null||pause,children:\"\\xBD Draw\"}),/*#__PURE__*/_jsxs(Button,{className:\"black-side resign-btn\",value:\"resign\",onClick:handleResign,disabled:gameResult!==null||pause,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-flag\"}),\" Resign\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"time-select-container\",children:/*#__PURE__*/_jsxs(Button,{className:\"select-timer pause-btn\",disabled:gameResult!==null||pause&&!/Paused/.test(pause),id:!pause?\"Pause\":\"Resume\",onClick:handlePauseOrResume,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-\".concat(!pause?\"pause\":\"play\")}),\" \",!pause?\"Pause\":\"Resume\"]})})]}),/*#__PURE__*/_jsx(ChatSection,{}),/*#__PURE__*/_jsx(Button,{className:\"exit-game\",disabled:gameResult===null,onClick:handleExit,children:\"Exit Game\"}),/*#__PURE__*/_jsx(Button,{className:\"center-board\",onClick:props.handleCenterBoard,children:\"Center Board\"})]});};export default GameBar;","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/Components/Main/Game/GameBar/GameBar.jsx"],"names":["React","useContext","useEffect","Col","Button","useDispatch","useSelector","ChatSection","SocketContext","SetMoveTimerContext","GameBar","props","dispatch","receiveDrawOffer","state","gameState","gameResult","socket","setMoveTimer","pause","playerInfo","appState","opponentInfo","handlePauseOrResume","event","listItemRef","createRef","action","currentTarget","id","message","from","username","className","ref","type","value","emit","handleGameOver","result","reason","winner","playername","handleOfferDraw","handleResign","on","removeAllListeners","handleExit","width","document","querySelector","offsetWidth","span","test","handleCenterBoard"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect } from \"react\";\r\nimport { Col, Button } from \"react-bootstrap\";\r\nimport \"./GameBar.scss\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport ChatSection from \"./ChatSection/ChatSection.jsx\";\r\nimport { SocketContext, SetMoveTimerContext } from \"../../../App/context.js\";\r\n\r\nconst GameBar = (props) => {\r\n  const dispatch = useDispatch();\r\n  const receiveDrawOffer = useSelector(\r\n    (state) => state.gameState.receiveDrawOffer\r\n  );\r\n  const gameResult = useSelector((state) => state.gameState.gameResult);\r\n  const socket = useContext(SocketContext);\r\n  const setMoveTimer = useContext(SetMoveTimerContext);\r\n  const pause = useSelector((state) => state.gameState.pause);\r\n  const playerInfo = useSelector((state) => state.appState.playerInfo);\r\n  const opponentInfo = useSelector((state) => state.gameState.opponentInfo);\r\n\r\n  const handlePauseOrResume = (event) => {\r\n    const listItemRef = React.createRef();\r\n    const action = event.currentTarget.id;\r\n    const message = {\r\n      from: `${playerInfo.username}`,\r\n      message: `${action}d Game`,\r\n      className: \"game-message\",\r\n      ref: listItemRef,\r\n    };\r\n    dispatch({ type: \"setMessage\", value: message });\r\n    dispatch({\r\n      type: \"setPause\",\r\n      value: `${playerInfo.username} ${action}d Game`,\r\n    });\r\n    socket.emit(`player${action}Game`);\r\n  };\r\n\r\n  const handleGameOver = (result, reason) => {\r\n    const listItemRef = React.createRef();\r\n    dispatch({ type: \"setGameResult\", value: result });\r\n    dispatch({\r\n      type: \"setMessage\",\r\n      value: {\r\n        type: \"game result message\",\r\n        winner: `${\r\n          result === \"Won\"\r\n            ? `${playerInfo.username}`\r\n            : `${opponentInfo.playername}`\r\n        } Won - `,\r\n        reason: reason,\r\n        className: \"game-message\",\r\n        ref: listItemRef,\r\n      },\r\n    });\r\n    setMoveTimer(null, true, dispatch);\r\n  };\r\n\r\n  const handleOfferDraw = () => {\r\n    if (!receiveDrawOffer) {\r\n      const listItemRef = React.createRef();\r\n      dispatch({\r\n        type: \"setMessage\",\r\n        value: {\r\n          from: `${playerInfo.username}`,\r\n          message: \"Offered A Draw\",\r\n          className: \"game-message\",\r\n          ref: listItemRef,\r\n        },\r\n      });\r\n      socket.emit(\"sendDrawOffer\");\r\n    }\r\n  };\r\n\r\n  const handleResign = () => {\r\n    handleGameOver(\"Lose\", `${playerInfo.username} Resign`);\r\n    socket.emit(\"gameFinish\", [\"Won\", `${playerInfo.username} Resign`]);\r\n  };\r\n\r\n  useEffect(() => {\r\n    socket.on(\"gameOver\", (result, reason) => {\r\n      if (gameResult !== null) return;\r\n      handleGameOver(result, reason);\r\n    });\r\n\r\n    socket.on(\"opponentLeftGame\", () => {\r\n      const listItemRef = React.createRef();\r\n      dispatch({\r\n        type: \"setMessage\",\r\n        value: {\r\n          from: `${opponentInfo.playername}`,\r\n          message: \"Left The Game\",\r\n          className: \"game-message\",\r\n          ref: listItemRef,\r\n        },\r\n      });\r\n    });\r\n\r\n    return () => {\r\n      socket.removeAllListeners(\"opponentLeftGame\");\r\n      socket.removeAllListeners(\"gameOver\");\r\n    };\r\n  });\r\n\r\n  const handleExit = () => {\r\n    const width = document.querySelector(\".board-container\").offsetWidth;\r\n    socket.emit(\"exitGame\");\r\n    dispatch({ type: \"resetBoardState\", value: width });\r\n    dispatch({ type: \"resetGameState\" });\r\n  };\r\n\r\n  return (\r\n    <Col\r\n      md={{ span: 4 }}\r\n      xs={{ span: 10 }}\r\n      className=\"game-controller mb-3 game-bar-controller\"\r\n    >\r\n      <div className=\"button-container game-bar\">\r\n        <div className=\"select-side-container\">\r\n          <Button\r\n            className=\"red-side draw-btn\"\r\n            value=\"draw\"\r\n            onClick={handleOfferDraw}\r\n            disabled={gameResult !== null || pause}\r\n          >\r\n            &#189; Draw\r\n          </Button>\r\n          <Button\r\n            className=\"black-side resign-btn\"\r\n            value=\"resign\"\r\n            onClick={handleResign}\r\n            disabled={gameResult !== null || pause}\r\n          >\r\n            <i className=\"fas fa-flag\"></i> Resign\r\n          </Button>\r\n        </div>\r\n        <div className=\"time-select-container\">\r\n          <Button\r\n            className=\"select-timer pause-btn\"\r\n            disabled={gameResult !== null || (pause && !/Paused/.test(pause))}\r\n            id={!pause ? \"Pause\" : \"Resume\"}\r\n            onClick={handlePauseOrResume}\r\n          >\r\n            <i className={`fas fa-${!pause ? \"pause\" : \"play\"}`}></i>{\" \"}\r\n            {!pause ? \"Pause\" : \"Resume\"}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      <ChatSection />\r\n      <Button\r\n        className=\"exit-game\"\r\n        disabled={gameResult === null}\r\n        onClick={handleExit}\r\n      >\r\n        Exit Game\r\n      </Button>\r\n      <Button className=\"center-board\" onClick={props.handleCenterBoard}>\r\n        Center Board\r\n      </Button>\r\n    </Col>\r\n  );\r\n};\r\n\r\nexport default GameBar;\r\n"]},"metadata":{},"sourceType":"module"}