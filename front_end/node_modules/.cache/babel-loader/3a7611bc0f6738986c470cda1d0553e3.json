{"ast":null,"code":"import _slicedToArray from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useEffect}from\"react\";import{SocketContext,SetMoveTimerContext}from\"../../App/context.js\";import\"./Game.scss\";import{Row}from\"react-bootstrap\";import GameController from\"./GameController/GameController.jsx\";import GamePlayArea from\"./GamePlayArea/GamePlayArea.jsx\";import{useSelector,useStore,useDispatch}from\"react-redux\";import GameBar from\"./GameBar/GameBar.jsx\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Game=function Game(){var dispatch=useDispatch();var _useState=useState(\"none\"),_useState2=_slicedToArray(_useState,2),timeSelectorDisplay=_useState2[0],setTimeSelectorDisplay=_useState2[1];var foundMatch=useSelector(function(state){return state.gameState.foundMatch;});var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),centerBoard=_useState4[0],setCenterBoard=_useState4[1];var socket=useContext(SocketContext);var lang=useSelector(function(state){return state.appState.lang;});var store=useStore();var setMoveTimer=useContext(SetMoveTimerContext);var handleCenterBoard=function handleCenterBoard(){setCenterBoard(!centerBoard);};var handleToggle=function handleToggle(){setTimeSelectorDisplay(timeSelectorDisplay===\"none\"?\"flex\":\"none\");};var handleGameOver=function handleGameOver(result,reason){var opponentInfo=store.getState().gameState.opponentInfo;var playerInfo=store.getState().appState.playerInfo;dispatch({type:\"setGameResult\",value:result});dispatch({type:\"setReceiveDrawOffer\",value:false});dispatch({type:\"setMessage\",value:{type:\"game result message\",winner:\"\".concat(result===\"Won\"?\"\".concat(playerInfo.username):\"\".concat(opponentInfo.playername),\" \").concat(lang===\"English\"?\"Won\":\"Thắng\",\" - \"),reason:lang===\"English\"?reason:reason===\"Game Abandoned\"?\"Trận Đấu Bị Hủy\":\"Chiếu Bí\",className:\"game-message\"}});setMoveTimer(null,true,dispatch);};var handleResign=function handleResign(){var playerInfo=store.getState().appState.playerInfo;handleGameOver(\"Lose\",\"\".concat(playerInfo.username,\" Resigned\"));socket.emit(\"gameFinish\",[\"Won\",\"\".concat(playerInfo.username,\" Resigned\")]);};useEffect(function(){socket.on(\"gameOver\",function(result,reason){var foundMatch=store.getState().gameState.foundMatch;var gameResult=store.getState().gameState.gameResult;if(gameResult!==null||!foundMatch)return;handleGameOver(result,reason);});socket.on(\"opponentLeftGame\",function(){var foundMatch=store.getState().gameState.foundMatch;var opponentInfo=store.getState().gameState.opponentInfo;if(foundMatch)dispatch({type:\"setMessage\",value:{from:\"\".concat(opponentInfo.playername),message:lang===\"English\"?\"Left The Game\":\"Đã Rời Trận\",className:\"game-message\"}});});return function(){socket.removeAllListeners(\"opponentLeftGame\");socket.removeAllListeners(\"gameOver\");};},[]);return/*#__PURE__*/_jsxs(Row,{md:{cols:1},className:\"mt-3 pb-3\",children:[/*#__PURE__*/_jsx(GamePlayArea,{lang:lang}),/*#__PURE__*/_jsx(\"div\",{className:\"w-100\",style:{display:centerBoard?\"block\":\"none\"}}),!foundMatch?/*#__PURE__*/_jsx(GameController,{timeSelectorDisplay:timeSelectorDisplay,handleToggle:handleToggle,handleCenterBoard:handleCenterBoard,centerBoard:centerBoard}):/*#__PURE__*/_jsx(GameBar,{handleCenterBoard:handleCenterBoard,centerBoard:centerBoard,handleResign:handleResign})]});};export default Game;","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/Components/Main/Game/Game.jsx"],"names":["React","useState","useContext","useEffect","SocketContext","SetMoveTimerContext","Row","GameController","GamePlayArea","useSelector","useStore","useDispatch","GameBar","Game","dispatch","timeSelectorDisplay","setTimeSelectorDisplay","foundMatch","state","gameState","centerBoard","setCenterBoard","socket","lang","appState","store","setMoveTimer","handleCenterBoard","handleToggle","handleGameOver","result","reason","opponentInfo","getState","playerInfo","type","value","winner","username","playername","className","handleResign","emit","on","gameResult","from","message","removeAllListeners","cols","display"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\r\nimport { SocketContext, SetMoveTimerContext } from \"../../App/context.js\";\r\nimport \"./Game.scss\";\r\nimport { Row } from \"react-bootstrap\";\r\nimport GameController from \"./GameController/GameController.jsx\";\r\nimport GamePlayArea from \"./GamePlayArea/GamePlayArea.jsx\";\r\nimport { useSelector, useStore, useDispatch } from \"react-redux\";\r\nimport GameBar from \"./GameBar/GameBar.jsx\";\r\n\r\nconst Game = () => {\r\n  const dispatch = useDispatch();\r\n  const [timeSelectorDisplay, setTimeSelectorDisplay] = useState(\"none\");\r\n  const foundMatch = useSelector((state) => state.gameState.foundMatch);\r\n  const [centerBoard, setCenterBoard] = useState(false);\r\n  const socket = useContext(SocketContext);\r\n  const lang = useSelector((state) => state.appState.lang);\r\n  const store = useStore();\r\n  const setMoveTimer = useContext(SetMoveTimerContext);\r\n\r\n  const handleCenterBoard = () => {\r\n    setCenterBoard(!centerBoard);\r\n  };\r\n\r\n  const handleToggle = () => {\r\n    setTimeSelectorDisplay(timeSelectorDisplay === \"none\" ? \"flex\" : \"none\");\r\n  };\r\n\r\n  const handleGameOver = (result, reason) => {\r\n    const opponentInfo = store.getState().gameState.opponentInfo;\r\n    const playerInfo = store.getState().appState.playerInfo;\r\n    dispatch({ type: \"setGameResult\", value: result });\r\n    dispatch({ type: \"setReceiveDrawOffer\", value: false });\r\n    dispatch({\r\n      type: \"setMessage\",\r\n      value: {\r\n        type: \"game result message\",\r\n        winner: `${\r\n          result === \"Won\"\r\n            ? `${playerInfo.username}`\r\n            : `${opponentInfo.playername}`\r\n        } ${lang === \"English\" ? \"Won\" : \"Thắng\"} - `,\r\n        reason:\r\n          lang === \"English\"\r\n            ? reason\r\n            : reason === \"Game Abandoned\"\r\n            ? \"Trận Đấu Bị Hủy\"\r\n            : \"Chiếu Bí\",\r\n        className: \"game-message\",\r\n      },\r\n    });\r\n    setMoveTimer(null, true, dispatch);\r\n  };\r\n\r\n  const handleResign = () => {\r\n    const playerInfo = store.getState().appState.playerInfo;\r\n    handleGameOver(\"Lose\", `${playerInfo.username} Resigned`);\r\n    socket.emit(\"gameFinish\", [\"Won\", `${playerInfo.username} Resigned`]);\r\n  };\r\n\r\n  useEffect(() => {\r\n    socket.on(\"gameOver\", (result, reason) => {\r\n      const foundMatch = store.getState().gameState.foundMatch;\r\n      const gameResult = store.getState().gameState.gameResult;\r\n      if (gameResult !== null || !foundMatch) return;\r\n      handleGameOver(result, reason);\r\n    });\r\n\r\n    socket.on(\"opponentLeftGame\", () => {\r\n      const foundMatch = store.getState().gameState.foundMatch;\r\n      const opponentInfo = store.getState().gameState.opponentInfo;\r\n      if (foundMatch)\r\n        dispatch({\r\n          type: \"setMessage\",\r\n          value: {\r\n            from: `${opponentInfo.playername}`,\r\n            message: lang === \"English\" ? \"Left The Game\" : \"Đã Rời Trận\",\r\n            className: \"game-message\",\r\n          },\r\n        });\r\n    });\r\n\r\n    return () => {\r\n      socket.removeAllListeners(\"opponentLeftGame\");\r\n      socket.removeAllListeners(\"gameOver\");\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <Row md={{ cols: 1 }} className=\"mt-3 pb-3\">\r\n      <GamePlayArea lang={lang} />\r\n      <div\r\n        className=\"w-100\"\r\n        style={{ display: centerBoard ? \"block\" : \"none\" }}\r\n      ></div>\r\n      {!foundMatch ? (\r\n        <GameController\r\n          timeSelectorDisplay={timeSelectorDisplay}\r\n          handleToggle={handleToggle}\r\n          handleCenterBoard={handleCenterBoard}\r\n          centerBoard={centerBoard}\r\n        />\r\n      ) : (\r\n        <GameBar\r\n          handleCenterBoard={handleCenterBoard}\r\n          centerBoard={centerBoard}\r\n          handleResign={handleResign}\r\n        />\r\n      )}\r\n    </Row>\r\n  );\r\n};\r\n\r\nexport default Game;\r\n"]},"metadata":{},"sourceType":"module"}