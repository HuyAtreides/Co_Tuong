{"ast":null,"code":"import _slicedToArray from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect}from\"react\";import\"./Pause.scss\";import{useSelector,useDispatch,useStore}from\"react-redux\";import{SocketContext,SetMoveTimerContext}from\"../../../../App/context.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Timer=function Timer(_ref){var lang=_ref.lang,pause=_ref.pause;var dispatch=useDispatch();var socket=useContext(SocketContext);var setMoveTimer=useContext(SetMoveTimerContext);var time=useSelector(function(state){return state.gameState.pauseTime;});var minute=Math.floor(time/60);var second=time%60;var store=useStore();useEffect(function(){if(time===0){if(/Paused/.test(pause)){dispatch({type:\"setPauseTime\",value:\"timeout\"});dispatch({type:\"setPause\",value:\"Timeout\"});socket.emit(\"startTimer\",true);}else{socket.emit(\"startGame\");}}socket.on(\"receiveGameStartSignal\",function(){socket.emit(\"receiveGameStartSignalAck\");});socket.on(\"gameStarted\",function(){var turnToMove=store.getState().boardState.turnToMove;dispatch({type:\"setPauseTime\",value:\"restart\"});dispatch({type:\"setPause\",value:null});socket.emit(\"startTimer\",false);dispatch({type:\"setPause\",value:null});dispatch({type:\"setPauseTime\",value:\"restart\"});setMoveTimer(turnToMove,false,dispatch);});return function(){socket.removeAllListeners(\"receiveGameStartSignal\");socket.removeAllListeners(\"gameStarted\");};},[time]);return/*#__PURE__*/_jsxs(\"p\",{className:\"pause-timer\",children:[/Paused/.test(pause)?lang===\"English\"?\"Resume In\":\"Tiếp Tục Trong\":lang===\"English\"?\"Game Will Start In\":\"Bắt Đầu Trận Trong\",\":\",\" \",/*#__PURE__*/_jsx(\"span\",{children:(minute<10?\"0\"+minute:minute)+\":\"+(second<10?\"0\"+second:second)})]});};var Pause=function Pause(){var dispatch=useDispatch();var lang=useSelector(function(state){return state.appState.lang;});var pause=useSelector(function(state){return state.gameState.pause;});var _useSelector=useSelector(function(state){return state.boardState.boardSize;}),_useSelector2=_slicedToArray(_useSelector,2),boardWidth=_useSelector2[0],boardHeight=_useSelector2[1];var store=useStore();var socket=useContext(SocketContext);var pauseAnnounce=pause;useEffect(function(){if(/Resumed/.test(pause))dispatch({type:\"setPauseTime\",value:\"timeout\"});var handleOpponentPauseOrResumeGame=function handleOpponentPauseOrResumeGame(pause){var opponentInfo=store.getState().gameState.opponentInfo;var action=pause?\"Paused\":\"Resumed\";var actionInVi=pause?\"Dừng\":\"Tiếp Tục\";var message={from:\"\".concat(opponentInfo.playername),message:lang===\"English\"?\"\".concat(action,\" Game\"):\"\".concat(actionInVi,\" Tr\\u1EADn\"),className:\"game-message\"};dispatch({type:\"setMessage\",value:message});dispatch({type:\"setPause\",value:\"\".concat(opponentInfo.playername,\" \").concat(pause?\"Paused\":\"Resumed\",\" Game\")});socket.emit(\"receive\".concat(pause?\"Pause\":\"Resume\",\"SignalAck\"));};socket.on(\"startPauseTimer\",function(){socket.removeAllListeners(\"oneSecondPass\");socket.on(\"oneSecondPass\",function(){dispatch({type:\"setPauseTime\",value:null});});socket.emit(\"startTimer\",true);});socket.on(\"opponentPauseGame\",function(){handleOpponentPauseOrResumeGame(true);});socket.on(\"opponentResumeGame\",function(){handleOpponentPauseOrResumeGame(false);});return function(){socket.removeAllListeners(\"opponentPauseGame\");socket.removeAllListeners(\"opponentResumeGame\");socket.removeAllListeners(\"startPauseTimer\");};},[pause]);if(!pause)return null;if(lang!==\"English\"){var name=pause.split(\" \")[0];if(/Paused/.test(pause))pauseAnnounce=name+\" Dừng Trận\";else if(/Resumed/.test(pause))pauseAnnounce=name+\" Tiếp Tục Trận\";else pauseAnnounce=\"Hết Thời Gian Dừng\";}return/*#__PURE__*/_jsx(\"div\",{className:\"pause\",style:{width:\"\".concat(boardWidth,\"px\"),height:\"\".concat(boardHeight,\"px\")},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"pause-announce\",children:pauseAnnounce}),/*#__PURE__*/_jsx(Timer,{pause:pause,lang:lang})]})});};export default/*#__PURE__*/React.memo(Pause);","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/Components/Main/Game/GamePlayArea/Pause/Pause.jsx"],"names":["React","useContext","useEffect","useSelector","useDispatch","useStore","SocketContext","SetMoveTimerContext","Timer","lang","pause","dispatch","socket","setMoveTimer","time","state","gameState","pauseTime","minute","Math","floor","second","store","test","type","value","emit","on","turnToMove","getState","boardState","removeAllListeners","Pause","appState","boardSize","boardWidth","boardHeight","pauseAnnounce","handleOpponentPauseOrResumeGame","opponentInfo","action","actionInVi","message","from","playername","className","name","split","width","height","memo"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect } from \"react\";\r\nimport \"./Pause.scss\";\r\nimport { useSelector, useDispatch, useStore } from \"react-redux\";\r\nimport { SocketContext, SetMoveTimerContext } from \"../../../../App/context.js\";\r\n\r\nconst Timer = ({ lang, pause }) => {\r\n  const dispatch = useDispatch();\r\n  const socket = useContext(SocketContext);\r\n  const setMoveTimer = useContext(SetMoveTimerContext);\r\n  const time = useSelector((state) => state.gameState.pauseTime);\r\n  const minute = Math.floor(time / 60);\r\n  const second = time % 60;\r\n  const store = useStore();\r\n  useEffect(() => {\r\n    if (time === 0) {\r\n      if (/Paused/.test(pause)) {\r\n        dispatch({ type: \"setPauseTime\", value: \"timeout\" });\r\n        dispatch({ type: \"setPause\", value: \"Timeout\" });\r\n        socket.emit(\"startTimer\", true);\r\n      } else {\r\n        socket.emit(\"startGame\");\r\n      }\r\n    }\r\n\r\n    socket.on(\"receiveGameStartSignal\", () => {\r\n      socket.emit(\"receiveGameStartSignalAck\");\r\n    });\r\n\r\n    socket.on(\"gameStarted\", () => {\r\n      const turnToMove = store.getState().boardState.turnToMove;\r\n      dispatch({ type: \"setPauseTime\", value: \"restart\" });\r\n      dispatch({ type: \"setPause\", value: null });\r\n      socket.emit(\"startTimer\", false);\r\n      dispatch({ type: \"setPause\", value: null });\r\n      dispatch({ type: \"setPauseTime\", value: \"restart\" });\r\n      setMoveTimer(turnToMove, false, dispatch);\r\n    });\r\n\r\n    return () => {\r\n      socket.removeAllListeners(\"receiveGameStartSignal\");\r\n      socket.removeAllListeners(\"gameStarted\");\r\n    };\r\n  }, [time]);\r\n\r\n  return (\r\n    <p className=\"pause-timer\">\r\n      {/Paused/.test(pause)\r\n        ? lang === \"English\"\r\n          ? \"Resume In\"\r\n          : \"Tiếp Tục Trong\"\r\n        : lang === \"English\"\r\n        ? \"Game Will Start In\"\r\n        : \"Bắt Đầu Trận Trong\"}\r\n      :{\" \"}\r\n      <span>\r\n        {(minute < 10 ? \"0\" + minute : minute) +\r\n          \":\" +\r\n          (second < 10 ? \"0\" + second : second)}\r\n      </span>\r\n    </p>\r\n  );\r\n};\r\n\r\nconst Pause = () => {\r\n  const dispatch = useDispatch();\r\n  const lang = useSelector((state) => state.appState.lang);\r\n  const pause = useSelector((state) => state.gameState.pause);\r\n  const [boardWidth, boardHeight] = useSelector(\r\n    (state) => state.boardState.boardSize\r\n  );\r\n  const store = useStore();\r\n  const socket = useContext(SocketContext);\r\n  let pauseAnnounce = pause;\r\n\r\n  useEffect(() => {\r\n    if (/Resumed/.test(pause))\r\n      dispatch({ type: \"setPauseTime\", value: \"timeout\" });\r\n\r\n    const handleOpponentPauseOrResumeGame = (pause) => {\r\n      const opponentInfo = store.getState().gameState.opponentInfo;\r\n      const action = pause ? \"Paused\" : \"Resumed\";\r\n      const actionInVi = pause ? \"Dừng\" : \"Tiếp Tục\";\r\n      const message = {\r\n        from: `${opponentInfo.playername}`,\r\n        message: lang === \"English\" ? `${action} Game` : `${actionInVi} Trận`,\r\n        className: \"game-message\",\r\n      };\r\n      dispatch({ type: \"setMessage\", value: message });\r\n      dispatch({\r\n        type: \"setPause\",\r\n        value: `${opponentInfo.playername} ${\r\n          pause ? \"Paused\" : \"Resumed\"\r\n        } Game`,\r\n      });\r\n      socket.emit(`receive${pause ? \"Pause\" : \"Resume\"}SignalAck`);\r\n    };\r\n\r\n    socket.on(\"startPauseTimer\", () => {\r\n      socket.removeAllListeners(\"oneSecondPass\");\r\n      socket.on(\"oneSecondPass\", () => {\r\n        dispatch({ type: \"setPauseTime\", value: null });\r\n      });\r\n      socket.emit(\"startTimer\", true);\r\n    });\r\n\r\n    socket.on(\"opponentPauseGame\", () => {\r\n      handleOpponentPauseOrResumeGame(true);\r\n    });\r\n\r\n    socket.on(\"opponentResumeGame\", () => {\r\n      handleOpponentPauseOrResumeGame(false);\r\n    });\r\n\r\n    return () => {\r\n      socket.removeAllListeners(\"opponentPauseGame\");\r\n      socket.removeAllListeners(\"opponentResumeGame\");\r\n      socket.removeAllListeners(\"startPauseTimer\");\r\n    };\r\n  }, [pause]);\r\n\r\n  if (!pause) return null;\r\n\r\n  if (lang !== \"English\") {\r\n    const name = pause.split(\" \")[0];\r\n    if (/Paused/.test(pause)) pauseAnnounce = name + \" Dừng Trận\";\r\n    else if (/Resumed/.test(pause)) pauseAnnounce = name + \" Tiếp Tục Trận\";\r\n    else pauseAnnounce = \"Hết Thời Gian Dừng\";\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"pause\"\r\n      style={{\r\n        width: `${boardWidth}px`,\r\n        height: `${boardHeight}px`,\r\n      }}\r\n    >\r\n      <div>\r\n        <p className=\"pause-announce\">{pauseAnnounce}</p>\r\n        <Timer pause={pause} lang={lang} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default React.memo(Pause);\r\n"]},"metadata":{},"sourceType":"module"}