{"ast":null,"code":"import Piece from \"./piece.js\";\nimport cannonRules from \"./move_rules/cannonRules.js\";\n\nclass Cannon extends Piece {\n  constructor(width, row, col, name, choosenSide) {\n    super(width, row, col, name, choosenSide);\n    this.moves = cannonRules;\n  }\n\n  setNewPosition(x, y, board, turnToMove) {\n    const newCol = Math.floor(x / this.width);\n    const newRow = Math.floor(y / this.width);\n    const [curRow, curCol] = this.position;\n    this.translate = `translate(${curCol * this.width}, ${curRow * this.width})`;\n\n    if (turnToMove && this.side === this.choosenSide[1]) {\n      const isValid = this.checkValidMove(newRow, newCol, board);\n\n      if (isValid && !/translate/.test(isValid)) {\n        if (!board[newRow][newCol].side) {\n          if (this.countPiecesBetween(newRow, newCol, board) === 0) return this.setPosition(false, newRow, newCol);\n        } else if (board[newRow][newCol].side !== board[curRow][curCol].side) if (this.countPiecesBetween(newRow, newCol, board) === 2) return this.setPosition(true, newRow, newCol);\n      } else if (isValid) return isValid;\n    }\n\n    return null;\n  }\n\n  canSaveGeneral(board) {\n    const [curRow, curCol] = this.position;\n\n    for (let move of this.moves) {\n      const tmpBoard = board.reduce((acc, row) => {\n        acc.push([...row]);\n        return acc;\n      }, []);\n      const [newRow, newCol] = [curRow + move[0], curCol + move[1]];\n\n      if (newCol >= this.minCol && newCol <= this.maxCol && newRow >= this.minRow && newRow <= this.maxRow) {\n        if (!tmpBoard[newRow][newCol]) {\n          if (this.countPiecesBetween(newRow, newCol, tmpBoard) === 0) {\n            this.updateTmpBoard(newRow, newCol, tmpBoard);\n            if (!Piece.isGeneralInDanger(tmpBoard, this.side)) return true;\n          }\n        } else if (tmpBoard[newRow][newCol].side !== this.side) {\n          if (this.countPiecesBetween(newRow, newCol, tmpBoard) === 2) {\n            this.updateTmpBoard(newRow, newCol, tmpBoard);\n            if (!Piece.isGeneralInDanger(tmpBoard, this.side)) return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  }\n\n  canCaptureGeneral(board) {\n    const [curRow, curCol] = this.position;\n\n    for (let move of this.moves) {\n      const [newRow, newCol] = [curRow + move[0], curCol + move[1]];\n\n      if (newCol >= 0 && newCol < 9 && newRow >= 0 && newRow < 10) {\n        if (board[newRow][newCol].side) if (board[newRow][newCol].side !== board[curRow][curCol].side) if (this.countPiecesBetween(newRow, newCol, board) === 2) if (board[newRow][newCol].name.split(\"-\")[0] === \"general\") return board[newRow][newCol].translate;\n      }\n    }\n\n    return false;\n  }\n\n}\n\nexport default Cannon;","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/pieces/cannon.js"],"names":["Piece","cannonRules","Cannon","constructor","width","row","col","name","choosenSide","moves","setNewPosition","x","y","board","turnToMove","newCol","Math","floor","newRow","curRow","curCol","position","translate","side","isValid","checkValidMove","test","countPiecesBetween","setPosition","canSaveGeneral","move","tmpBoard","reduce","acc","push","minCol","maxCol","minRow","maxRow","updateTmpBoard","isGeneralInDanger","canCaptureGeneral","split"],"mappings":"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","sourcesContent":["import Piece from \"./piece.js\";\r\nimport cannonRules from \"./move_rules/cannonRules.js\";\r\n\r\nclass Cannon extends Piece {\r\n  constructor(width, row, col, name, choosenSide) {\r\n    super(width, row, col, name, choosenSide);\r\n    this.moves = cannonRules;\r\n  }\r\n\r\n  setNewPosition(x, y, board, turnToMove) {\r\n    const newCol = Math.floor(x / this.width);\r\n    const newRow = Math.floor(y / this.width);\r\n    const [curRow, curCol] = this.position;\r\n    this.translate = `translate(${curCol * this.width}, ${\r\n      curRow * this.width\r\n    })`;\r\n    if (turnToMove && this.side === this.choosenSide[1]) {\r\n      const isValid = this.checkValidMove(newRow, newCol, board);\r\n      if (isValid && !/translate/.test(isValid)) {\r\n        if (!board[newRow][newCol].side) {\r\n          if (this.countPiecesBetween(newRow, newCol, board) === 0)\r\n            return this.setPosition(false, newRow, newCol);\r\n        } else if (board[newRow][newCol].side !== board[curRow][curCol].side)\r\n          if (this.countPiecesBetween(newRow, newCol, board) === 2)\r\n            return this.setPosition(true, newRow, newCol);\r\n      } else if (isValid) return isValid;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  canSaveGeneral(board) {\r\n    const [curRow, curCol] = this.position;\r\n    for (let move of this.moves) {\r\n      const tmpBoard = board.reduce((acc, row) => {\r\n        acc.push([...row]);\r\n        return acc;\r\n      }, []);\r\n      const [newRow, newCol] = [curRow + move[0], curCol + move[1]];\r\n      if (\r\n        newCol >= this.minCol &&\r\n        newCol <= this.maxCol &&\r\n        newRow >= this.minRow &&\r\n        newRow <= this.maxRow\r\n      ) {\r\n        if (!tmpBoard[newRow][newCol]) {\r\n          if (this.countPiecesBetween(newRow, newCol, tmpBoard) === 0) {\r\n            this.updateTmpBoard(newRow, newCol, tmpBoard);\r\n            if (!Piece.isGeneralInDanger(tmpBoard, this.side)) return true;\r\n          }\r\n        } else if (tmpBoard[newRow][newCol].side !== this.side) {\r\n          if (this.countPiecesBetween(newRow, newCol, tmpBoard) === 2) {\r\n            this.updateTmpBoard(newRow, newCol, tmpBoard);\r\n            if (!Piece.isGeneralInDanger(tmpBoard, this.side)) return true;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  canCaptureGeneral(board) {\r\n    const [curRow, curCol] = this.position;\r\n    for (let move of this.moves) {\r\n      const [newRow, newCol] = [curRow + move[0], curCol + move[1]];\r\n      if (newCol >= 0 && newCol < 9 && newRow >= 0 && newRow < 10) {\r\n        if (board[newRow][newCol].side)\r\n          if (board[newRow][newCol].side !== board[curRow][curCol].side)\r\n            if (this.countPiecesBetween(newRow, newCol, board) === 2)\r\n              if (board[newRow][newCol].name.split(\"-\")[0] === \"general\")\r\n                return board[newRow][newCol].translate;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\nexport default Cannon;\r\n"]},"metadata":{},"sourceType":"module"}