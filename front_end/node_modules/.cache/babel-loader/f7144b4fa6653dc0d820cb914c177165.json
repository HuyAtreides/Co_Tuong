{"ast":null,"code":"import React,{useEffect,useContext}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import\"./DrawOffer.scss\";import{Button}from\"react-bootstrap\";import{SocketContext,SetMoveTimerContext}from\"../../../../../App/context.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DrawOffer=function DrawOffer(props){var dispatch=useDispatch();var socket=useContext(SocketContext);var lang=useSelector(function(state){return state.appState.lang;});var setMoveTimer=useContext(SetMoveTimerContext);var playerInfo=useSelector(function(state){return state.appState.playerInfo;});var opponentInfo=useSelector(function(state){return state.gameState.opponentInfo;});var gameResult=useSelector(function(state){return state.gameState.gameResult;});var receiveDrawOffer=useSelector(function(state){return state.gameState.receiveDrawOffer;});var handleDrawResult=function handleDrawResult(){dispatch({type:\"setGameResult\",value:\"Draw\"});dispatch({type:\"setMessage\",value:{type:\"game result message\",winner:\"\",reason:lang===\"English\"?\"Game Draw By Agreement\":\"Chấp Nhận Hòa\",className:\"game-message\"}});setMoveTimer(null,true,dispatch);};var handleAcceptOffer=function handleAcceptOffer(){dispatch({type:\"setReceiveDrawOffer\",value:false});if(!gameResult){handleDrawResult();socket.emit(\"gameFinish\",\"Draw\");}};var handleDeclineOffer=function handleDeclineOffer(){var mess=lang===\"English\"?\"Declined A Draw\":\"Từ Chối Hòa\";dispatch({type:\"setReceiveDrawOffer\",value:false});dispatch({type:\"setMessage\",value:{from:\"\".concat(playerInfo.username),message:mess,className:\"game-message\"}});socket.emit(\"sendMessage\",{from:\"\".concat(playerInfo.username),message:mess,className:\"game-message\"});};useEffect(function(){socket.on(\"receiveDrawOffer\",function(){dispatch({type:\"setReceiveDrawOffer\",value:true});});socket.on(\"draw\",function(){handleDrawResult();});return function(){socket.removeAllListeners(\"draw\");socket.removeAllListeners(\"receiveDrawOffer\");};});if(!receiveDrawOffer)return null;return/*#__PURE__*/_jsxs(\"li\",{className:\"draw-offer\",style:{display:props.display},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:opponentInfo.playername}),\" \",lang===\"English\"?\"Offer A Draw\":\"Đề Nghị Hòa\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"answer\",children:[/*#__PURE__*/_jsxs(Button,{className:\"accept-offer\",onClick:handleAcceptOffer,children:[lang===\"English\"?\"Accept\":\"Đồng Ý\",\" \",/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check\"})]}),/*#__PURE__*/_jsxs(Button,{className:\"decline-offer\",onClick:handleDeclineOffer,children:[lang===\"English\"?\"Decline\":\"Từ Chối\",\" \",/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\"})]})]})]});};export default DrawOffer;","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/Components/Main/Game/GameBar/ChatSection/DrawOffer/DrawOffer.jsx"],"names":["React","useEffect","useContext","useSelector","useDispatch","Button","SocketContext","SetMoveTimerContext","DrawOffer","props","dispatch","socket","lang","state","appState","setMoveTimer","playerInfo","opponentInfo","gameState","gameResult","receiveDrawOffer","handleDrawResult","type","value","winner","reason","className","handleAcceptOffer","emit","handleDeclineOffer","mess","from","username","message","on","removeAllListeners","display","playername"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport \"./DrawOffer.scss\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport {\r\n  SocketContext,\r\n  SetMoveTimerContext,\r\n} from \"../../../../../App/context.js\";\r\n\r\nconst DrawOffer = (props) => {\r\n  const dispatch = useDispatch();\r\n  const socket = useContext(SocketContext);\r\n  const lang = useSelector((state) => state.appState.lang);\r\n  const setMoveTimer = useContext(SetMoveTimerContext);\r\n  const playerInfo = useSelector((state) => state.appState.playerInfo);\r\n  const opponentInfo = useSelector((state) => state.gameState.opponentInfo);\r\n  const gameResult = useSelector((state) => state.gameState.gameResult);\r\n  const receiveDrawOffer = useSelector(\r\n    (state) => state.gameState.receiveDrawOffer\r\n  );\r\n\r\n  const handleDrawResult = () => {\r\n    dispatch({ type: \"setGameResult\", value: \"Draw\" });\r\n    dispatch({\r\n      type: \"setMessage\",\r\n      value: {\r\n        type: \"game result message\",\r\n        winner: \"\",\r\n        reason: lang === \"English\" ? \"Game Draw By Agreement\" : \"Chấp Nhận Hòa\",\r\n        className: \"game-message\",\r\n      },\r\n    });\r\n    setMoveTimer(null, true, dispatch);\r\n  };\r\n\r\n  const handleAcceptOffer = () => {\r\n    dispatch({ type: \"setReceiveDrawOffer\", value: false });\r\n    if (!gameResult) {\r\n      handleDrawResult();\r\n      socket.emit(\"gameFinish\", \"Draw\");\r\n    }\r\n  };\r\n\r\n  const handleDeclineOffer = () => {\r\n    const mess = lang === \"English\" ? \"Declined A Draw\" : \"Từ Chối Hòa\";\r\n    dispatch({ type: \"setReceiveDrawOffer\", value: false });\r\n    dispatch({\r\n      type: \"setMessage\",\r\n      value: {\r\n        from: `${playerInfo.username}`,\r\n        message: mess,\r\n        className: \"game-message\",\r\n      },\r\n    });\r\n    socket.emit(\"sendMessage\", {\r\n      from: `${playerInfo.username}`,\r\n      message: mess,\r\n      className: \"game-message\",\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    socket.on(\"receiveDrawOffer\", () => {\r\n      dispatch({ type: \"setReceiveDrawOffer\", value: true });\r\n    });\r\n\r\n    socket.on(\"draw\", () => {\r\n      handleDrawResult();\r\n    });\r\n\r\n    return () => {\r\n      socket.removeAllListeners(\"draw\");\r\n      socket.removeAllListeners(\"receiveDrawOffer\");\r\n    };\r\n  });\r\n\r\n  if (!receiveDrawOffer) return null;\r\n  return (\r\n    <li className=\"draw-offer\" style={{ display: props.display }}>\r\n      <p>\r\n        <span>{opponentInfo.playername}</span>{\" \"}\r\n        {lang === \"English\" ? \"Offer A Draw\" : \"Đề Nghị Hòa\"}\r\n      </p>\r\n      <div className=\"answer\">\r\n        <Button className=\"accept-offer\" onClick={handleAcceptOffer}>\r\n          {lang === \"English\" ? \"Accept\" : \"Đồng Ý\"}{\" \"}\r\n          <i className=\"fas fa-check\"></i>\r\n        </Button>\r\n        <Button className=\"decline-offer\" onClick={handleDeclineOffer}>\r\n          {lang === \"English\" ? \"Decline\" : \"Từ Chối\"}{\" \"}\r\n          <i className=\"fas fa-times\"></i>\r\n        </Button>\r\n      </div>\r\n    </li>\r\n  );\r\n};\r\n\r\nexport default DrawOffer;\r\n"]},"metadata":{},"sourceType":"module"}