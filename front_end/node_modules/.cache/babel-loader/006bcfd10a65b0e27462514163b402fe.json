{"ast":null,"code":"import _regeneratorRuntime from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from\"react\";import useValidateInput from\"./useValidateInput.js\";import{Container,Form,InputGroup,Button,Spinner,Row,Col}from\"react-bootstrap\";import{useDispatch,useSelector}from\"react-redux\";import{Redirect}from\"react-router-dom\";import{AuthenticateUserContext}from\"../App/context.js\";import callAPI from\"../App/callAPI.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Signup=function Signup(){var dispatch=useDispatch();var isAuthenticated=useSelector(function(state){return state.appState.isAuthenticated;});var lang=useSelector(function(state){return state.appState.lang;});var authenticateUser=useContext(AuthenticateUserContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),waitForResponse=_useState2[0],setWaitForResponse=_useState2[1];var _useValidateInput=useValidateInput(false,false,lang),handleEmailChange=_useValidateInput.handleEmailChange,handleError=_useValidateInput.handleError,setError=_useValidateInput.setError,handleFirstnameChange=_useValidateInput.handleFirstnameChange,handleLastnameChange=_useValidateInput.handleLastnameChange,handleMissingField=_useValidateInput.handleMissingField,handleUsernameChange=_useValidateInput.handleUsernameChange,handlePasswordChange=_useValidateInput.handlePasswordChange,username=_useValidateInput.username,password=_useValidateInput.password,lastname=_useValidateInput.lastname,firstname=_useValidateInput.firstname,email=_useValidateInput.email,invalidEmailMess=_useValidateInput.invalidEmailMess,invalidPasswordMess=_useValidateInput.invalidPasswordMess,invalidUsernameMess=_useValidateInput.invalidUsernameMess,error=_useValidateInput.error,showPassword=_useValidateInput.showPassword,setShowPassword=_useValidateInput.setShowPassword,confirmPassword=_useValidateInput.confirmPassword,handleConfirmPasswordChange=_useValidateInput.handleConfirmPasswordChange,confirmPasswordMess=_useValidateInput.confirmPasswordMess,setConfirmPasswordMess=_useValidateInput.setConfirmPasswordMess;var handleSignUp=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var missingField,_yield$callAPI,message,user,ok,opponentID;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;event.preventDefault();if(!waitForResponse){_context.next=4;break;}return _context.abrupt(\"return\");case 4:setError(\"\");missingField=handleMissingField();if(!(confirmPassword!==password)){_context.next=9;break;}setConfirmPasswordMess(lang===\"English\"?\"Password doesn't match\":\"Mật khẩu không khớp\");return _context.abrupt(\"return\");case 9:if(!(!missingField&&!invalidEmailMess&&!invalidPasswordMess&&!invalidUsernameMess&&!confirmPasswordMess)){_context.next=21;break;}setWaitForResponse(true);setError(null);_context.next=14;return callAPI(\"POST\",\"api/signup\",{email:email,firstname:firstname,username:username,password:password,lastname:lastname});case 14:_yield$callAPI=_context.sent;message=_yield$callAPI.message;user=_yield$callAPI.user;ok=_yield$callAPI.ok;opponentID=_yield$callAPI.opponentID;setWaitForResponse(false);if(user){authenticateUser(dispatch,user,opponentID);}else handleError(ok,message);case 21:_context.next=27;break;case 23:_context.prev=23;_context.t0=_context[\"catch\"](0);setWaitForResponse(false);handleError(false,_context.t0.toString());case 27:case\"end\":return _context.stop();}}},_callee,null,[[0,23]]);}));return function handleSignUp(_x){return _ref.apply(this,arguments);};}();if(isAuthenticated){if(isAuthenticated!==\"guest\")return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});}return/*#__PURE__*/_jsxs(Container,{fluid:true,children:[/*#__PURE__*/_jsx(\"h1\",{children:lang===\"English\"?\"Xiangqi\":\"Cờ Tướng\"}),\"(\",/*#__PURE__*/_jsx(Row,{className:\"justify-content-center\",children:/*#__PURE__*/_jsxs(Col,{md:{span:7},sm:{span:7},xs:{span:10},className:\"login-component d-flex flex-column  align-items-center\",children:[error?/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}):null,/*#__PURE__*/_jsxs(Form,{onSubmit:handleSignUp,method:\"POST\",children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"username\",children:[/*#__PURE__*/_jsx(Form.Label,{children:lang===\"English\"?\"Username\":\"Tên tài khoản\"}),/*#__PURE__*/_jsxs(InputGroup,{hasValidation:true,children:[/*#__PURE__*/_jsx(Form.Control,{type:\"text\",isInvalid:invalidUsernameMess!==\"\",onChange:handleUsernameChange,value:username,disabled:waitForResponse}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:invalidUsernameMess})]})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"firstname\",children:[/*#__PURE__*/_jsx(Form.Label,{children:lang===\"English\"?\"Firstname\":\"Họ\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",onChange:handleFirstnameChange,value:firstname,disabled:waitForResponse})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"lastname\",children:[/*#__PURE__*/_jsx(Form.Label,{children:lang===\"English\"?\"Lastname\":\"tên\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",onChange:handleLastnameChange,value:lastname,disabled:waitForResponse})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email\"}),/*#__PURE__*/_jsxs(InputGroup,{hasValidation:true,children:[/*#__PURE__*/_jsx(Form.Control,{type:\"email\",isInvalid:invalidEmailMess!==\"\",onChange:handleEmailChange,value:email,disabled:waitForResponse}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:invalidEmailMess})]})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"password\",children:[/*#__PURE__*/_jsx(Form.Label,{children:lang===\"English\"?\"Password\":\"Mật Khẩu\"}),/*#__PURE__*/_jsxs(InputGroup,{hasValidation:true,className:\"password-group\",children:[/*#__PURE__*/_jsx(Form.Control,{type:showPassword?\"text\":\"password\",isInvalid:invalidPasswordMess!==\"\",onChange:handlePasswordChange,value:password,disabled:waitForResponse}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:invalidPasswordMess}),/*#__PURE__*/_jsx(\"button\",{className:\"toggle-password\",type:\"button\",style:{display:invalidPasswordMess?\"none\":\"inline\"},onClick:function onClick(){setShowPassword(!showPassword);},children:showPassword?lang===\"English\"?\"Hide\":\"Ẩn\":lang===\"English\"?\"Show\":\"Hiện\"})]})]}),/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:lang===\"English\"?\"Confirm Password\":\"Xác nhận mật khẩu\"}),/*#__PURE__*/_jsxs(InputGroup,{hasValidation:true,children:[/*#__PURE__*/_jsx(Form.Control,{type:\"password\",isInvalid:confirmPasswordMess!==\"\",disabled:waitForResponse,value:confirmPassword,onChange:handleConfirmPasswordChange}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:confirmPasswordMess})]})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",className:\"submit-form-button\",children:waitForResponse?/*#__PURE__*/_jsx(Spinner,{animation:\"border\",variant:\"dark\"}):lang===\"English\"?\"Submit\":\"Đăng Ký\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"seperator\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"seperator-text\",children:lang===\"English\"?\"or connect with\":\"hoặc đăng nhập với\"}),/*#__PURE__*/_jsx(\"span\",{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"social-login\",children:[/*#__PURE__*/_jsxs(\"a\",{className:\"google\",href:\"/api/auth/google\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fab fa-google\"}),\" Google\"]}),/*#__PURE__*/_jsxs(\"a\",{className:\"facebook\",href:\"/api/auth/facebook\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fab fa-facebook \"}),\" Facebook\"]}),/*#__PURE__*/_jsxs(\"a\",{className:\"github\",href:\"/api/auth/github\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fab fa-github \"}),\" Github\"]})]})]})})]});};export default Signup;","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/Components/Signup/Signup.jsx"],"names":["React","useState","useContext","useValidateInput","Container","Form","InputGroup","Button","Spinner","Row","Col","useDispatch","useSelector","Redirect","AuthenticateUserContext","callAPI","Signup","dispatch","isAuthenticated","state","appState","lang","authenticateUser","waitForResponse","setWaitForResponse","handleEmailChange","handleError","setError","handleFirstnameChange","handleLastnameChange","handleMissingField","handleUsernameChange","handlePasswordChange","username","password","lastname","firstname","email","invalidEmailMess","invalidPasswordMess","invalidUsernameMess","error","showPassword","setShowPassword","confirmPassword","handleConfirmPasswordChange","confirmPasswordMess","setConfirmPasswordMess","handleSignUp","event","preventDefault","missingField","message","user","ok","opponentID","toString","span","display"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from \"react\";\r\nimport useValidateInput from \"./useValidateInput.js\";\r\nimport {\r\n  Container,\r\n  Form,\r\n  InputGroup,\r\n  Button,\r\n  Spinner,\r\n  Row,\r\n  Col,\r\n} from \"react-bootstrap\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { AuthenticateUserContext } from \"../App/context.js\";\r\nimport callAPI from \"../App/callAPI.js\";\r\n\r\nconst Signup = () => {\r\n  const dispatch = useDispatch();\r\n  const isAuthenticated = useSelector(\r\n    (state) => state.appState.isAuthenticated\r\n  );\r\n  const lang = useSelector((state) => state.appState.lang);\r\n  const authenticateUser = useContext(AuthenticateUserContext);\r\n  const [waitForResponse, setWaitForResponse] = useState(false);\r\n  const {\r\n    handleEmailChange,\r\n    handleError,\r\n    setError,\r\n    handleFirstnameChange,\r\n    handleLastnameChange,\r\n    handleMissingField,\r\n    handleUsernameChange,\r\n    handlePasswordChange,\r\n    username,\r\n    password,\r\n    lastname,\r\n    firstname,\r\n    email,\r\n    invalidEmailMess,\r\n    invalidPasswordMess,\r\n    invalidUsernameMess,\r\n    error,\r\n    showPassword,\r\n    setShowPassword,\r\n    confirmPassword,\r\n    handleConfirmPasswordChange,\r\n    confirmPasswordMess,\r\n    setConfirmPasswordMess,\r\n  } = useValidateInput(false, false, lang);\r\n\r\n  const handleSignUp = async (event) => {\r\n    try {\r\n      event.preventDefault();\r\n      if (waitForResponse) return;\r\n      setError(\"\");\r\n      const missingField = handleMissingField();\r\n      if (confirmPassword !== password) {\r\n        setConfirmPasswordMess(\r\n          lang === \"English\" ? \"Password doesn't match\" : \"Mật khẩu không khớp\"\r\n        );\r\n        return;\r\n      }\r\n      if (\r\n        !missingField &&\r\n        !invalidEmailMess &&\r\n        !invalidPasswordMess &&\r\n        !invalidUsernameMess &&\r\n        !confirmPasswordMess\r\n      ) {\r\n        setWaitForResponse(true);\r\n        setError(null);\r\n        const { message, user, ok, opponentID } = await callAPI(\r\n          \"POST\",\r\n          \"api/signup\",\r\n          {\r\n            email: email,\r\n            firstname: firstname,\r\n            username: username,\r\n            password: password,\r\n            lastname: lastname,\r\n          }\r\n        );\r\n        setWaitForResponse(false);\r\n        if (user) {\r\n          authenticateUser(dispatch, user, opponentID);\r\n        } else handleError(ok, message);\r\n      }\r\n    } catch (err) {\r\n      setWaitForResponse(false);\r\n      handleError(false, err.toString());\r\n    }\r\n  };\r\n\r\n  if (isAuthenticated) {\r\n    if (isAuthenticated !== \"guest\") return <Redirect to=\"/\" />;\r\n  }\r\n\r\n  return (\r\n    <Container fluid>\r\n      <h1>{lang === \"English\" ? \"Xiangqi\" : \"Cờ Tướng\"}</h1>(\r\n      <Row className=\"justify-content-center\">\r\n        <Col\r\n          md={{ span: 7 }}\r\n          sm={{ span: 7 }}\r\n          xs={{ span: 10 }}\r\n          className=\"login-component d-flex flex-column  align-items-center\"\r\n        >\r\n          {error ? <p className=\"error-message\">{error}</p> : null}\r\n          <Form onSubmit={handleSignUp} method=\"POST\">\r\n            <Form.Group controlId=\"username\">\r\n              <Form.Label>\r\n                {lang === \"English\" ? \"Username\" : \"Tên tài khoản\"}\r\n              </Form.Label>\r\n              <InputGroup hasValidation>\r\n                <Form.Control\r\n                  type=\"text\"\r\n                  isInvalid={invalidUsernameMess !== \"\"}\r\n                  onChange={handleUsernameChange}\r\n                  value={username}\r\n                  disabled={waitForResponse}\r\n                />\r\n                <Form.Control.Feedback type=\"invalid\">\r\n                  {invalidUsernameMess}\r\n                </Form.Control.Feedback>\r\n              </InputGroup>\r\n            </Form.Group>\r\n\r\n            <Form.Group controlId=\"firstname\">\r\n              <Form.Label>{lang === \"English\" ? \"Firstname\" : \"Họ\"}</Form.Label>\r\n              <Form.Control\r\n                type=\"text\"\r\n                onChange={handleFirstnameChange}\r\n                value={firstname}\r\n                disabled={waitForResponse}\r\n              />\r\n            </Form.Group>\r\n\r\n            <Form.Group controlId=\"lastname\">\r\n              <Form.Label>{lang === \"English\" ? \"Lastname\" : \"tên\"}</Form.Label>\r\n              <Form.Control\r\n                type=\"text\"\r\n                onChange={handleLastnameChange}\r\n                value={lastname}\r\n                disabled={waitForResponse}\r\n              />\r\n            </Form.Group>\r\n\r\n            <Form.Group controlId=\"email\">\r\n              <Form.Label>Email</Form.Label>\r\n              <InputGroup hasValidation>\r\n                <Form.Control\r\n                  type=\"email\"\r\n                  isInvalid={invalidEmailMess !== \"\"}\r\n                  onChange={handleEmailChange}\r\n                  value={email}\r\n                  disabled={waitForResponse}\r\n                />\r\n                <Form.Control.Feedback type=\"invalid\">\r\n                  {invalidEmailMess}\r\n                </Form.Control.Feedback>\r\n              </InputGroup>\r\n            </Form.Group>\r\n            <Form.Group controlId=\"password\">\r\n              <Form.Label>\r\n                {lang === \"English\" ? \"Password\" : \"Mật Khẩu\"}\r\n              </Form.Label>\r\n              <InputGroup hasValidation className=\"password-group\">\r\n                <Form.Control\r\n                  type={showPassword ? \"text\" : \"password\"}\r\n                  isInvalid={invalidPasswordMess !== \"\"}\r\n                  onChange={handlePasswordChange}\r\n                  value={password}\r\n                  disabled={waitForResponse}\r\n                />\r\n                <Form.Control.Feedback type=\"invalid\">\r\n                  {invalidPasswordMess}\r\n                </Form.Control.Feedback>\r\n                <button\r\n                  className=\"toggle-password\"\r\n                  type=\"button\"\r\n                  style={{ display: invalidPasswordMess ? \"none\" : \"inline\" }}\r\n                  onClick={() => {\r\n                    setShowPassword(!showPassword);\r\n                  }}\r\n                >\r\n                  {showPassword\r\n                    ? lang === \"English\"\r\n                      ? \"Hide\"\r\n                      : \"Ẩn\"\r\n                    : lang === \"English\"\r\n                    ? \"Show\"\r\n                    : \"Hiện\"}\r\n                </button>\r\n              </InputGroup>\r\n            </Form.Group>\r\n            <Form.Group>\r\n              <Form.Label>\r\n                {lang === \"English\" ? \"Confirm Password\" : \"Xác nhận mật khẩu\"}\r\n              </Form.Label>\r\n              <InputGroup hasValidation>\r\n                <Form.Control\r\n                  type=\"password\"\r\n                  isInvalid={confirmPasswordMess !== \"\"}\r\n                  disabled={waitForResponse}\r\n                  value={confirmPassword}\r\n                  onChange={handleConfirmPasswordChange}\r\n                />\r\n                <Form.Control.Feedback type=\"invalid\">\r\n                  {confirmPasswordMess}\r\n                </Form.Control.Feedback>\r\n              </InputGroup>\r\n            </Form.Group>\r\n            <Button type=\"submit\" className=\"submit-form-button\">\r\n              {waitForResponse ? (\r\n                <Spinner animation=\"border\" variant=\"dark\" />\r\n              ) : lang === \"English\" ? (\r\n                \"Submit\"\r\n              ) : (\r\n                \"Đăng Ký\"\r\n              )}\r\n            </Button>\r\n          </Form>\r\n          <p className=\"seperator\">\r\n            <span></span>\r\n            <span className=\"seperator-text\">\r\n              {lang === \"English\" ? \"or connect with\" : \"hoặc đăng nhập với\"}\r\n            </span>\r\n            <span></span>\r\n          </p>\r\n          <div className=\"social-login\">\r\n            <a className=\"google\" href=\"/api/auth/google\">\r\n              <i className=\"fab fa-google\"></i> Google\r\n            </a>\r\n            <a className=\"facebook\" href=\"/api/auth/facebook\">\r\n              <i className=\"fab fa-facebook \"></i> Facebook\r\n            </a>\r\n            <a className=\"github\" href=\"/api/auth/github\">\r\n              <i className=\"fab fa-github \"></i> Github\r\n            </a>\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Signup;\r\n"]},"metadata":{},"sourceType":"module"}