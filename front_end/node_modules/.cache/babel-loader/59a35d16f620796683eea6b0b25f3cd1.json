{"ast":null,"code":"import horseRules from \"./move_rules/horseRules.js\";\nimport Piece from \"./piece.js\";\n\nclass Horse extends Piece {\n  constructor(width, row, col, name, choosenSide) {\n    super(width, row, col, name, choosenSide);\n    this.moves = horseRules;\n  }\n\n  canMoveToNewPosition(newRow, newCol, board) {\n    const [curRow, curCol] = this.position;\n    const [translateX, translateY] = [curCol * this.width, curRow * this.width];\n    this.translate = `translate(${translateX}, ${translateY})`;\n\n    if (this.side === this.choosenSide[1]) {\n      const isValid = this.checkValidMove(newRow, newCol, board);\n\n      if (isValid && !/translate/.test(isValid)) {\n        if (!this.isBlocked(newRow, newCol, board)) {\n          if (!board[newRow][newCol].side) {\n            return true;\n          } else if (board[newRow][newCol].side !== board[curRow][curCol].side) return \"capture\";\n        }\n      } else if (isValid) return isValid;\n    }\n\n    return false;\n  } // canSaveGeneral(board) {\n  //   const [curRow, curCol] = this.position;\n  //   for (let move of this.moves) {\n  //     const tmpBoard = board.reduce((acc, row) => {\n  //       acc.push([...row]);\n  //       return acc;\n  //     }, []);\n  //     const [newRow, newCol] = [curRow + move[0], curCol + move[1]];\n  //     if (\n  //       newCol >= this.minCol &&\n  //       newCol <= this.maxCol &&\n  //       newRow >= this.minRow &&\n  //       newRow <= this.maxRow &&\n  //       !this.isBlocked(newRow, newCol, tmpBoard)\n  //     ) {\n  //       if (!tmpBoard[newRow][newCol].side) {\n  //         if (this.countPiecesBetween(newRow, newCol, tmpBoard) === 0) {\n  //           this.updateTmpBoard(newRow, newCol, tmpBoard);\n  //           if (!Piece.isGeneralInDanger(tmpBoard, this.side)) return true;\n  //         }\n  //       } else if (tmpBoard[newRow][newCol].side !== this.side) {\n  //         if (this.countPiecesBetween(newRow, newCol, tmpBoard) == 1) {\n  //           this.updateTmpBoard(newRow, newCol, tmpBoard);\n  //           if (!Piece.isGeneralInDanger(tmpBoard, this.side)) return true;\n  //         }\n  //       }\n  //     }\n  //   }\n  //   return false;\n  // }\n\n\n  isBlocked(newRow, newCol, board) {\n    const [curRow, curCol] = this.position;\n    const [moveRow, moveCol] = [newRow - curRow, newCol - curCol];\n\n    if (Math.abs(moveRow) === 2) {\n      return board[curRow + moveRow / 2][curCol] !== 0;\n    } else {\n      return board[curRow][curCol + moveCol / 2] !== 0;\n    }\n  }\n\n  canCaptureGeneral(tmpBoard) {\n    const [curRow, curCol] = this.position;\n\n    for (let move of this.moves) {\n      const [newRow, newCol] = [curRow + move[0], curCol + move[1]];\n\n      if (newCol >= 0 && newCol < 9 && newRow >= 0 && newRow < 10) {\n        if (tmpBoard[newRow][newCol].side) if (tmpBoard[newRow][newCol].side !== tmpBoard[curRow][curCol].side) if (!this.isBlocked(newRow, newCol, tmpBoard)) if (tmpBoard[newRow][newCol].name.split(\"-\")[0] === \"general\") {\n          const width = tmpBoard[newRow][newCol].width;\n          const translate = `translate(${newCol * width}, ${newRow * width})`;\n          return translate;\n        }\n      }\n    }\n\n    return false;\n  }\n\n}\n\nexport default Horse;","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/pieces/horse.js"],"names":["horseRules","Piece","Horse","constructor","width","row","col","name","choosenSide","moves","canMoveToNewPosition","newRow","newCol","board","curRow","curCol","position","translateX","translateY","translate","side","isValid","checkValidMove","test","isBlocked","moveRow","moveCol","Math","abs","canCaptureGeneral","tmpBoard","move","split"],"mappings":"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","sourcesContent":["import horseRules from \"./move_rules/horseRules.js\";\r\nimport Piece from \"./piece.js\";\r\n\r\nclass Horse extends Piece {\r\n  constructor(width, row, col, name, choosenSide) {\r\n    super(width, row, col, name, choosenSide);\r\n    this.moves = horseRules;\r\n  }\r\n\r\n  canMoveToNewPosition(newRow, newCol, board) {\r\n    const [curRow, curCol] = this.position;\r\n    const [translateX, translateY] = [curCol * this.width, curRow * this.width];\r\n    this.translate = `translate(${translateX}, ${translateY})`;\r\n    if (this.side === this.choosenSide[1]) {\r\n      const isValid = this.checkValidMove(newRow, newCol, board);\r\n      if (isValid && !/translate/.test(isValid)) {\r\n        if (!this.isBlocked(newRow, newCol, board)) {\r\n          if (!board[newRow][newCol].side) {\r\n            return true;\r\n          } else if (board[newRow][newCol].side !== board[curRow][curCol].side)\r\n            return \"capture\";\r\n        }\r\n      } else if (isValid) return isValid;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // canSaveGeneral(board) {\r\n  //   const [curRow, curCol] = this.position;\r\n  //   for (let move of this.moves) {\r\n  //     const tmpBoard = board.reduce((acc, row) => {\r\n  //       acc.push([...row]);\r\n  //       return acc;\r\n  //     }, []);\r\n  //     const [newRow, newCol] = [curRow + move[0], curCol + move[1]];\r\n  //     if (\r\n  //       newCol >= this.minCol &&\r\n  //       newCol <= this.maxCol &&\r\n  //       newRow >= this.minRow &&\r\n  //       newRow <= this.maxRow &&\r\n  //       !this.isBlocked(newRow, newCol, tmpBoard)\r\n  //     ) {\r\n  //       if (!tmpBoard[newRow][newCol].side) {\r\n  //         if (this.countPiecesBetween(newRow, newCol, tmpBoard) === 0) {\r\n  //           this.updateTmpBoard(newRow, newCol, tmpBoard);\r\n  //           if (!Piece.isGeneralInDanger(tmpBoard, this.side)) return true;\r\n  //         }\r\n  //       } else if (tmpBoard[newRow][newCol].side !== this.side) {\r\n  //         if (this.countPiecesBetween(newRow, newCol, tmpBoard) == 1) {\r\n  //           this.updateTmpBoard(newRow, newCol, tmpBoard);\r\n  //           if (!Piece.isGeneralInDanger(tmpBoard, this.side)) return true;\r\n  //         }\r\n  //       }\r\n  //     }\r\n  //   }\r\n  //   return false;\r\n  // }\r\n\r\n  isBlocked(newRow, newCol, board) {\r\n    const [curRow, curCol] = this.position;\r\n    const [moveRow, moveCol] = [newRow - curRow, newCol - curCol];\r\n    if (Math.abs(moveRow) === 2) {\r\n      return board[curRow + moveRow / 2][curCol] !== 0;\r\n    } else {\r\n      return board[curRow][curCol + moveCol / 2] !== 0;\r\n    }\r\n  }\r\n\r\n  canCaptureGeneral(tmpBoard) {\r\n    const [curRow, curCol] = this.position;\r\n    for (let move of this.moves) {\r\n      const [newRow, newCol] = [curRow + move[0], curCol + move[1]];\r\n      if (newCol >= 0 && newCol < 9 && newRow >= 0 && newRow < 10) {\r\n        if (tmpBoard[newRow][newCol].side)\r\n          if (tmpBoard[newRow][newCol].side !== tmpBoard[curRow][curCol].side)\r\n            if (!this.isBlocked(newRow, newCol, tmpBoard))\r\n              if (tmpBoard[newRow][newCol].name.split(\"-\")[0] === \"general\") {\r\n                const width = tmpBoard[newRow][newCol].width;\r\n                const translate = `translate(${newCol * width}, ${\r\n                  newRow * width\r\n                })`;\r\n                return translate;\r\n              }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\nexport default Horse;\r\n"]},"metadata":{},"sourceType":"module"}