{"ast":null,"code":"import _slicedToArray from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useRef,useEffect,useContext}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{Button}from\"react-bootstrap\";import\"./ChatSection.scss\";import renderMessages from\"./renderMessages.js\";import DrawOffer from\"./DrawOffer/DrawOffer.jsx\";import{SocketContext}from\"../../../../App/context.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChatSection=function ChatSection(){var dispatch=useDispatch();var socket=useContext(SocketContext);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var messagesContainerRef=useRef();var lang=useSelector(function(state){return state.appState.lang;});var messages=useSelector(function(state){return state.gameState.messages;});var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),hideChat=_useState4[0],setHideChat=_useState4[1];var displayMessages=renderMessages(messages,lang);var playerInfo=useSelector(function(state){return state.appState.playerInfo;});var opponentInfo=useSelector(function(state){return state.gameState.opponentInfo;});var handleOnChange=function handleOnChange(event){setInput(event.currentTarget.value);};var handleHideChat=function handleHideChat(){setHideChat(true);};var handleShowChat=function handleShowChat(){setHideChat(false);};var handleSendMessage=function handleSendMessage(event){event.preventDefault();if(input){var message={from:\"\".concat(playerInfo.username,\": \"),message:input,className:\"\"};dispatch({type:\"setMessage\",value:message});setInput(\"\");socket.emit(\"sendMessage\",message);}};useEffect(function(){if(messages.length>0){var list=messagesContainerRef.current;var lastListItem=document.querySelector(\"#m\".concat(messages.length-1));if(lastListItem){list.scrollTop=lastListItem.offsetTop;}}socket.on(\"incomingMessage\",function(message){if(message.from&&message.className!==\"game-message\")message.from=\"\".concat(opponentInfo.playername,\": \");dispatch({type:\"setMessage\",value:message});});return function(){socket.removeAllListeners(\"incomingMessage\");};});return hideChat?/*#__PURE__*/_jsxs(Button,{className:\"show-chat\",onClick:handleShowChat,children:[lang===\"English\"?\"Show Chat\":\"Hiện Chat\",/*#__PURE__*/_jsx(DrawOffer,{display:\"none\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"chat-section\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times hide-chat\",onClick:handleHideChat}),/*#__PURE__*/_jsxs(\"ul\",{className:\"message-container\",ref:messagesContainerRef,children:[/*#__PURE__*/_jsx(\"li\",{className:\"announce-new-game\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"versus game-message\",children:[/*#__PURE__*/_jsx(\"span\",{children:opponentInfo.playername}),\" vs\",\" \",/*#__PURE__*/_jsx(\"span\",{children:playerInfo.username})]})}),displayMessages]}),/*#__PURE__*/_jsx(DrawOffer,{display:\"flex\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"chat-input\",onSubmit:handleSendMessage,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:lang===\"English\"?\"Message...\":\"Tin Nhắn...\",onChange:handleOnChange,value:input}),/*#__PURE__*/_jsx(Button,{className:\"send-btn\",type:\"submit\",children:lang===\"English\"?\"Send\":\"Gửi\"})]})]});};export default ChatSection;","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/Components/Main/Game/GameBar/ChatSection/ChatSection.jsx"],"names":["React","useState","useRef","useEffect","useContext","useSelector","useDispatch","Button","renderMessages","DrawOffer","SocketContext","ChatSection","dispatch","socket","input","setInput","messagesContainerRef","lang","state","appState","messages","gameState","hideChat","setHideChat","displayMessages","playerInfo","opponentInfo","handleOnChange","event","currentTarget","value","handleHideChat","handleShowChat","handleSendMessage","preventDefault","message","from","username","className","type","emit","length","list","current","lastListItem","document","querySelector","scrollTop","offsetTop","on","playername","removeAllListeners"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect, useContext } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport \"./ChatSection.scss\";\r\nimport renderMessages from \"./renderMessages.js\";\r\nimport DrawOffer from \"./DrawOffer/DrawOffer.jsx\";\r\nimport { SocketContext } from \"../../../../App/context.js\";\r\n\r\nconst ChatSection = () => {\r\n  const dispatch = useDispatch();\r\n  const socket = useContext(SocketContext);\r\n  const [input, setInput] = useState(\"\");\r\n  const messagesContainerRef = useRef();\r\n  const lang = useSelector((state) => state.appState.lang);\r\n  const messages = useSelector((state) => state.gameState.messages);\r\n  const [hideChat, setHideChat] = useState(false);\r\n  const displayMessages = renderMessages(messages, lang);\r\n  const playerInfo = useSelector((state) => state.appState.playerInfo);\r\n  const opponentInfo = useSelector((state) => state.gameState.opponentInfo);\r\n\r\n  const handleOnChange = (event) => {\r\n    setInput(event.currentTarget.value);\r\n  };\r\n\r\n  const handleHideChat = () => {\r\n    setHideChat(true);\r\n  };\r\n\r\n  const handleShowChat = () => {\r\n    setHideChat(false);\r\n  };\r\n\r\n  const handleSendMessage = (event) => {\r\n    event.preventDefault();\r\n    if (input) {\r\n      const message = {\r\n        from: `${playerInfo.username}: `,\r\n        message: input,\r\n        className: \"\",\r\n      };\r\n      dispatch({ type: \"setMessage\", value: message });\r\n      setInput(\"\");\r\n      socket.emit(\"sendMessage\", message);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (messages.length > 0) {\r\n      const list = messagesContainerRef.current;\r\n      const lastListItem = document.querySelector(`#m${messages.length - 1}`);\r\n      if (lastListItem) {\r\n        list.scrollTop = lastListItem.offsetTop;\r\n      }\r\n    }\r\n    socket.on(\"incomingMessage\", (message) => {\r\n      if (message.from && message.className !== \"game-message\")\r\n        message.from = `${opponentInfo.playername}: `;\r\n      dispatch({ type: \"setMessage\", value: message });\r\n    });\r\n\r\n    return () => {\r\n      socket.removeAllListeners(\"incomingMessage\");\r\n    };\r\n  });\r\n\r\n  return hideChat ? (\r\n    <Button className=\"show-chat\" onClick={handleShowChat}>\r\n      {lang === \"English\" ? \"Show Chat\" : \"Hiện Chat\"}\r\n      <DrawOffer display=\"none\" />\r\n    </Button>\r\n  ) : (\r\n    <div className=\"chat-section\">\r\n      <i className=\"fas fa-times hide-chat\" onClick={handleHideChat}></i>\r\n      <ul className=\"message-container\" ref={messagesContainerRef}>\r\n        <li className=\"announce-new-game\">\r\n          <p className=\"versus game-message\">\r\n            <span>{opponentInfo.playername}</span> vs{\" \"}\r\n            <span>{playerInfo.username}</span>\r\n          </p>\r\n        </li>\r\n        {displayMessages}\r\n      </ul>\r\n      <DrawOffer display=\"flex\" />\r\n      <form className=\"chat-input\" onSubmit={handleSendMessage}>\r\n        <input\r\n          type=\"text\"\r\n          placeholder={lang === \"English\" ? \"Message...\" : \"Tin Nhắn...\"}\r\n          onChange={handleOnChange}\r\n          value={input}\r\n        />\r\n        <Button className=\"send-btn\" type=\"submit\">\r\n          {lang === \"English\" ? \"Send\" : \"Gửi\"}\r\n        </Button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatSection;\r\n"]},"metadata":{},"sourceType":"module"}