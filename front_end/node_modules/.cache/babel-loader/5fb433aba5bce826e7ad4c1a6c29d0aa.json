{"ast":null,"code":"import _objectSpread from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"F:/Web/C\\u1EDD T\\u01B0\\u1EDBng/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{Spinner,OverlayTrigger,Tooltip}from\"react-bootstrap\";import\"./ProfileHeader.scss\";import{Link}from\"react-router-dom\";import callAPI from\"../../App/callAPI.js\";import{useDispatch,useSelector}from\"react-redux\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ProfileHeader=function ProfileHeader(props){var playerInfo=props.playerInfo,setError=props.setError,viewOthersProfile=props.viewOthersProfile,setting=props.setting;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),waitForResponse=_useState2[0],setWaitForResponse=_useState2[1];var dispatch=useDispatch();var lang=useSelector(function(state){return state.appState.lang;});var firstname=playerInfo.name.firstname;var lastname=playerInfo.name.lastname;var playerFullName=firstname+\" \"+lastname;var handleChangeProfilePic=function handleChangeProfilePic(){var inputElement=document.querySelector(\"#pic-input\");inputElement.click();};var upload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var formData,file,name,_yield$callAPI,user,message;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;formData=new FormData();file=event.currentTarget.files[0];name=event.currentTarget.name;formData.append(name,file);setWaitForResponse(true);_context.next=8;return callAPI(\"POST\",\"uploads/\".concat(playerInfo._id),formData,true);case 8:_yield$callAPI=_context.sent;user=_yield$callAPI.user;message=_yield$callAPI.message;setWaitForResponse(false);if(user){dispatch({type:\"setPlayerInfo\",value:user});}else if(message){setError(message===\"Only image files are allowed.\"&&lang!==\"English\"?\"Tập tin không hợp lệ.\":message);}_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](0);setError(lang===\"English\"?\"Looks like there was an error. Please refresh.\":\"Đã xảy ra lỗi. Vui lòng tải lại trang.\");case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,15]]);}));return function upload(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"change-pic-area \".concat(setting?\"setting-img\":\"\"),children:[!waitForResponse&&!viewOthersProfile?/*#__PURE__*/_jsxs(\"button\",{className:\"change-pic\",onClick:handleChangeProfilePic,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera\"}),lang===\"English\"?\"Change\":\"Thay Đổi\"]}):null,/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",id:\"pic-input\",onChange:upload,name:playerInfo._id}),!waitForResponse?/*#__PURE__*/_jsx(\"img\",{src:playerInfo.photo}):/*#__PURE__*/_jsx(Spinner,{animation:\"border\",variant:\"secondary\"})]}),/*#__PURE__*/_jsxs(\"div\",{id:viewOthersProfile?\"other-profile\":\"\",className:\"user-profile-info \".concat(setting?\"setting-profile-info\":\"\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-name-lastname\",children:[/*#__PURE__*/_jsx(OverlayTrigger,{placement:\"top\",overlay:function overlay(props){return/*#__PURE__*/_jsx(Tooltip,_objectSpread(_objectSpread({id:\"profile-name-tooltip\"},props),{},{children:playerInfo.username}));},children:/*#__PURE__*/_jsx(\"p\",{className:\"user-name\",children:playerInfo.username})}),/*#__PURE__*/_jsx(OverlayTrigger,{placement:\"top\",overlay:function overlay(props){return/*#__PURE__*/_jsx(Tooltip,_objectSpread(_objectSpread({id:\"profile-name-tooltip\"},props),{},{children:playerFullName}));},children:/*#__PURE__*/_jsx(\"p\",{className:\"user-full-name\",children:playerFullName})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"edit-profile-container\",children:!viewOthersProfile&&!setting?/*#__PURE__*/_jsxs(Link,{to:\"/settings\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\"}),\" \",lang===\"English\"?\"Edit\":\"Chỉnh Sửa\"]}):null})]})]});};export default ProfileHeader;","map":{"version":3,"sources":["F:/Web/Cờ Tướng/front_end/src/Components/Home/ProfileHeader/ProfileHeader.jsx"],"names":["React","useState","Spinner","OverlayTrigger","Tooltip","Link","callAPI","useDispatch","useSelector","ProfileHeader","props","playerInfo","setError","viewOthersProfile","setting","waitForResponse","setWaitForResponse","dispatch","lang","state","appState","firstname","name","lastname","playerFullName","handleChangeProfilePic","inputElement","document","querySelector","click","upload","event","formData","FormData","file","currentTarget","files","append","_id","user","message","type","value","photo","username"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport { Spinner, OverlayTrigger, Tooltip } from \"react-bootstrap\";\r\nimport \"./ProfileHeader.scss\";\r\nimport { Link } from \"react-router-dom\";\r\nimport callAPI from \"../../App/callAPI.js\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nconst ProfileHeader = (props) => {\r\n  const { playerInfo, setError, viewOthersProfile, setting } = props;\r\n  const [waitForResponse, setWaitForResponse] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const lang = useSelector((state) => state.appState.lang);\r\n  const firstname = playerInfo.name.firstname;\r\n  const lastname = playerInfo.name.lastname;\r\n  const playerFullName = firstname + \" \" + lastname;\r\n\r\n  const handleChangeProfilePic = () => {\r\n    const inputElement = document.querySelector(\"#pic-input\");\r\n    inputElement.click();\r\n  };\r\n\r\n  const upload = async (event) => {\r\n    try {\r\n      const formData = new FormData();\r\n      const file = event.currentTarget.files[0];\r\n      const name = event.currentTarget.name;\r\n      formData.append(name, file);\r\n      setWaitForResponse(true);\r\n      const { user, message } = await callAPI(\r\n        \"POST\",\r\n        `uploads/${playerInfo._id}`,\r\n        formData,\r\n        true\r\n      );\r\n      setWaitForResponse(false);\r\n      if (user) {\r\n        dispatch({ type: \"setPlayerInfo\", value: user });\r\n      } else if (message) {\r\n        setError(\r\n          message === \"Only image files are allowed.\" && lang !== \"English\"\r\n            ? \"Tập tin không hợp lệ.\"\r\n            : message\r\n        );\r\n      }\r\n    } catch (err) {\r\n      setError(\r\n        lang === \"English\"\r\n          ? \"Looks like there was an error. Please refresh.\"\r\n          : \"Đã xảy ra lỗi. Vui lòng tải lại trang.\"\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"profile-header\">\r\n      <div className={`change-pic-area ${setting ? \"setting-img\" : \"\"}`}>\r\n        {!waitForResponse && !viewOthersProfile ? (\r\n          <button className=\"change-pic\" onClick={handleChangeProfilePic}>\r\n            <i className=\"fas fa-camera\"></i>\r\n            {lang === \"English\" ? \"Change\" : \"Thay Đổi\"}\r\n          </button>\r\n        ) : null}\r\n        <input\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          id=\"pic-input\"\r\n          onChange={upload}\r\n          name={playerInfo._id}\r\n        />\r\n        {!waitForResponse ? (\r\n          <img src={playerInfo.photo} />\r\n        ) : (\r\n          <Spinner animation=\"border\" variant=\"secondary\" />\r\n        )}\r\n      </div>\r\n      <div\r\n        id={viewOthersProfile ? \"other-profile\" : \"\"}\r\n        className={`user-profile-info ${setting ? \"setting-profile-info\" : \"\"}`}\r\n      >\r\n        <div className=\"user-name-lastname\">\r\n          <OverlayTrigger\r\n            placement=\"top\"\r\n            overlay={(props) => (\r\n              <Tooltip id=\"profile-name-tooltip\" {...props}>\r\n                {playerInfo.username}\r\n              </Tooltip>\r\n            )}\r\n          >\r\n            <p className=\"user-name\">{playerInfo.username}</p>\r\n          </OverlayTrigger>\r\n          <OverlayTrigger\r\n            placement=\"top\"\r\n            overlay={(props) => (\r\n              <Tooltip id=\"profile-name-tooltip\" {...props}>\r\n                {playerFullName}\r\n              </Tooltip>\r\n            )}\r\n          >\r\n            <p className=\"user-full-name\">{playerFullName}</p>\r\n          </OverlayTrigger>\r\n        </div>\r\n        <div className=\"edit-profile-container\">\r\n          {!viewOthersProfile && !setting ? (\r\n            <Link to=\"/settings\">\r\n              <i className=\"fas fa-edit\"></i>{\" \"}\r\n              {lang === \"English\" ? \"Edit\" : \"Chỉnh Sửa\"}\r\n            </Link>\r\n          ) : null}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProfileHeader;\r\n"]},"metadata":{},"sourceType":"module"}